---
title: Jeu 2D avec l'API Device orientation
slug: Games/Workflows/HTML5_Gamedev_Phaser_Device_Orientation_FR
translation_of: Games/Tutorials/HTML5_Gamedev_Phaser_Device_Orientation
---
<div>{{GamesSidebar}}</div><p>{{IncludeSubnav("/fr/docs/Jeux")}}  </p>

<p class="summary">Dans ce tutoriel, <span id="result_box" lang="fr"><span>nous allons passer par le processus de construction d'un jeu mobile HTML5 qui utilise les API </span></span> <a href="https://developer.mozilla.org/fr/Apps/Fundamentals/gather_and_modify_data/responding_to_device_orientation_changes">Device Orientation</a>  et <a href="https://developer.mozilla.org/fr/docs/Web/API/Vibration_API">Vibration</a>   <span id="result_box" lang="fr"><span>pour améliorer le "gameplay" et est construit avec le </span></span>"framework" <a class="external external-icon" href="http://phaser.io/">Phaser </a>. <span id="result_box" lang="fr"><span>La connaissance JavaScript de base est recommandée pour tirer le meilleur parti de ce tutoriel.</span></span></p>

<h2 id="Exemple_de_jeu">Exemple de jeu</h2>

<p>A la fin de ce tutoriel, vous aurez une démo entièrement fonctionnelle du jeu : <a href="http://orb.enclavegames.com/">Cyber Orb</a>. <span id="result_box" lang="fr"><span class="hps">Il</span> <span class="hps">ressemblera à quelque chose</span> <span class="hps">comme cela :</span></span></p>

<p><img alt="A 2D game board featuring a small yellow ball. There is a large black hole for the ball to escape down, and a number of barriers blocking the ball from escaping." src="https://mdn.mozillademos.org/files/10297/cyber-orb.png" style="display: block; height: 450px; margin: 0px auto; width: 300px;"></p>

<h2 id="Le_framework_Phaser">Le framework Phaser</h2>

<p><a href="http://phaser.io/">Phaser</a> est un framework pour créer des jeux mobiles et PC en utilisant les technologies HTML5. Malgré son manque de maturité, la communauté est assez active, et il évolue rapidement.  Les sources sont<a href="https://github.com/photonstorm/phaser"> sur Github</a>, lisez y la <a href="http://docs.phaser.io/">documentation</a> de base, jetez un œil aux <a href="http://examples.phaser.io/">exemples</a>. Le framework Phaser offre un ensemble d'outils qui permettent d'accélérer le développement et aident à mettre en oeuvre les tâches courantes nécessaires au développement d'un  jeu.</p>

<h2 id="Mise_en_place_du_projet">Mise en place du projet</h2>

<p>Vous pouvez voir <a href="https://github.com/EnclaveGames/Cyber-Orb">le code d'exemple du projet</a> sur GitHub. La structure n'est pas compliquée : le point de départ est le fichier <code>index.html</code> où nous initialisons le framework, mettons en place le {{htmlelement("canvas")}} et jouons au jeu.</p>

<p><img alt="Screenshot of the GitHub repository with the Cyber Orb game code, listing the folders and the files in the main structure." src="https://mdn.mozillademos.org/files/10357/cyber-orb-github.png" style="height: 423px; width: 620px;"></p>

<p>Vous pouvez l'ouvir avec votre navigateur préféré pour essayer le jeu. Il y a aussi trois dossiers :</p>

<ul>
 <li><code>img</code> : toutes les images utilisées dans le jeu</li>
 <li><code>src</code> : les fichiers JavaScript où le code source est défini</li>
 <li>audio : tous les fichiers son du jeu</li>
</ul>

<h2 id="Mettre_en_place_le_canevas">Mettre en place le canevas</h2>

<p><span id="result_box" lang="fr"><span>Nous voulons un rendu de notre jeu sur un canevas, mais nous ne le ferons pas manuellement - cela sera pris en charge par le framework.</span></span> <span id="result_box" lang="fr"><span>Disons-le : notre point de départ est le fichier<code> index.html</code> avec le contenu suivant.</span> <span>Vous pouvez créer vous-même si vous voulez suivre :</span></span></p>

<pre class="brush: html line-numbers  language-html"><code class="language-html"><span class="doctype token">&lt;!DOCTYPE html&gt;</span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>html</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>head</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>meta</span> <span class="attr-name token">charset</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>utf-8<span class="punctuation token">"</span></span> <span class="punctuation token">/&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>title</span><span class="punctuation token">&gt;</span></span>Cyber Orb demo<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>title</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>style</span><span class="punctuation token">&gt;</span></span><span class="language-css style token"> <span class="selector token">body </span><span class="punctuation token">{</span> <span class="property token">margin</span><span class="punctuation token">:</span> <span class="number token">0</span><span class="punctuation token">;</span> <span class="property token">background</span><span class="punctuation token">:</span> <span class="hexcode token">#333</span><span class="punctuation token">;</span> <span class="punctuation token">}</span> </span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>style</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/phaser-arcade-physics.2.2.2.min.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/Boot.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/Preloader.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/MainMenu.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/Howto.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>src/Game.js<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>head</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>body</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>script</span><span class="punctuation token">&gt;</span></span><span class="language-javascript script token">
<span class="punctuation token">(</span><span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> game <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">Phaser<span class="punctuation token">.</span>Game</span><span class="punctuation token">(</span><span class="number token">320</span><span class="punctuation token">,</span> <span class="number token">480</span><span class="punctuation token">,</span> Phaser<span class="punctuation token">.</span>CANVAS<span class="punctuation token">,</span> <span class="string token">'game'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">add</span><span class="punctuation token">(</span><span class="string token">'Boot'</span><span class="punctuation token">,</span> Ball<span class="punctuation token">.</span>Boot<span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">add</span><span class="punctuation token">(</span><span class="string token">'Preloader'</span><span class="punctuation token">,</span> Ball<span class="punctuation token">.</span>Preloader<span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">add</span><span class="punctuation token">(</span><span class="string token">'MainMenu'</span><span class="punctuation token">,</span> Ball<span class="punctuation token">.</span>MainMenu<span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">add</span><span class="punctuation token">(</span><span class="string token">'Howto'</span><span class="punctuation token">,</span> Ball<span class="punctuation token">.</span>Howto<span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">add</span><span class="punctuation token">(</span><span class="string token">'Game'</span><span class="punctuation token">,</span> Ball<span class="punctuation token">.</span>Game<span class="punctuation token">)</span><span class="punctuation token">;</span>
    game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'Boot'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
</span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>script</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>body</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>html</span><span class="punctuation token">&gt;</span></span></code></pre>

<p>Ça ressemble à une simple page de site HTML avec des éléments basiques dans la balise <code>&lt;head&gt;</code> <em>(en-tête)</em> : police de caractères, titre, CSS et inclusion des fichiers Javascript. Le <code>&lt;body&gt;</code> <em>(corps)</em> contient l'initialisation du framework et la définition des états du jeu.</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> game <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">Phaser<span class="punctuation token">.</span>Game</span><span class="punctuation token">(</span><span class="number token">320</span><span class="punctuation token">,</span> <span class="number token">480</span><span class="punctuation token">,</span> Phaser<span class="punctuation token">.</span>CANVAS<span class="punctuation token">,</span> <span class="string token">'game'</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>La ligne ci-dessus va initialiser l'instance de Phaser - les arguments sont la largeur et la hauteur </span></span><span lang="fr"><span>du canevas, la méthode de rendu (nous utilisons <code>CANVAS</code>, mais il y a aussi les options <code>WEBGL</code> et <code>AUTO</code> disponibles) et l'ID optionnel du conteneur DOM</span> dans lequel <span>nous voulons placer le canevas. Si rien n'est spécifié dans ce dernier argument, ou si l'élément n'est pas trouvé, le <code>canvas</code> sera ajouté à la balise <code>&lt;body&gt;</code>.</span> <span>Sans le framework, pour ajouter l'élément <code>canvas</code> à la page, il faudrait écrire quelque chose comme ça dans la balise <code>&lt;body&gt;</code>:</span></span></p>

<pre class="brush: html line-numbers  language-html"><code class="language-html"><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>canvas</span> <span class="attr-name token">id</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">'</span>game<span class="punctuation token">'</span></span> <span class="attr-name token">width</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">'</span>320<span class="punctuation token">'</span></span> <span class="attr-name token">height</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">'</span>480<span class="punctuation token">'</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>canvas</span><span class="punctuation token">&gt;</span></span></code></pre>

<p><span id="result_box" lang="fr"><span>La chose importante à retenir est que le framework met en place des méthodes utiles pour accélérer beaucoup de choses comme la manipulation d'images ou la gestion des éléments, ce qui serait beaucoup plus difficile à faire manuellement.</span></span></p>

<div class="note">
<p><strong>Note </strong>: Vous pouvez lire l'article <a href="http://gamedevelopment.tutsplus.com/tutorials/getting-started-with-phaser-building-monster-wants-candy--cms-21723">Building Monster Wants Candy</a> <span id="result_box" lang="fr"><span>pour une introduction approfondie aux fonctions et méthodes de base de Phaser.</span></span></p>
</div>

<p><span id="result_box" lang="fr"><span>Retour aux états du jeu : la ligne ci-dessous ajoute un nouvel état appelé Boot au jeu :</span></span></p>

<pre class="brush: html line-numbers  language-html"><code class="language-html">game.state.add('Boot', Ball.Boot);</code></pre>

<p><span id="result_box" lang="fr"><span>La première valeur est le nom de l'état et la seconde est l'objet que nous voulons lui assigner.</span> <span>La méthode </span></span> <code>start</code> <span lang="fr"><span> démarre l'état donné et le rend actif.</span> <span>Voyons ce que les états sont en réalité.</span></span> </p>

<h2 id="Gestion_des_états_du_jeu">Gestion des états du jeu</h2>

<p>Les états du jeu dans Phaser sont différentes phases du jeu. Dans notre cas, ils sont chargés depuis des fichiers Javascript pour mieux les maintenir par la suite. Dans ce jeu nous avons les états : <code>Boot <em>(démarrage)</em></code>, <code>Preloader <em>(préchargement)</em></code>, <code>MainMenu <em>(menu principal), </em></code> <code>Howto</code> <em>(comment jouer)</em> et <code>Game <em>(jeu)</em></code>. <code>Boot</code> s'occupe d'initialiser quelques paramètres, <code>Preloader</code> charge tous les graphismes et les sons, <code>MainMenu</code> est le menu avec le bouton start, <code>Howto</code> affiche les instructions "comment jouer" et <code>Game</code>, est l'état qui permet de  jouer. <span class="short_text" id="result_box" lang="fr"><span>Passons rapidement au contenu de ces états.</span></span></p>

<h3 id="Boot.js_(démarrage)">Boot.js <em>(démarrage)</em></h3>

<p>L'état <code>Boot</code> est le premier du jeu.</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> Ball <span class="operator token">=</span> <span class="punctuation token">{</span>
    _WIDTH<span class="punctuation token">:</span> <span class="number token">320</span><span class="punctuation token">,</span>
    _HEIGHT<span class="punctuation token">:</span> <span class="number token">480</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>Boot <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span>game<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>Boot<span class="punctuation token">.</span>prototype <span class="operator token">=</span> <span class="punctuation token">{</span>
    preload<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">image</span><span class="punctuation token">(</span><span class="string token">'preloaderBg'</span><span class="punctuation token">,</span> <span class="string token">'img/loading-bg.png'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">image</span><span class="punctuation token">(</span><span class="string token">'preloaderBar'</span><span class="punctuation token">,</span> <span class="string token">'img/loading-bar.png'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span><span class="punctuation token">,</span>
    create<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>scale<span class="punctuation token">.</span>scaleMode <span class="operator token">=</span> Phaser<span class="punctuation token">.</span>ScaleManager<span class="punctuation token">.</span>SHOW_ALL<span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>scale<span class="punctuation token">.</span>pageAlignHorizontally <span class="operator token">=</span> <span class="keyword token">true</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>scale<span class="punctuation token">.</span>pageAlignVertically <span class="operator token">=</span> <span class="keyword token">true</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'Preloader'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Le principal objet "<code>Ball</code>"  est défini et nous ajoutons deux variables appelées <code>_WIDTH</code> et <code>_HEIGHT</code> qui sont la largeur et la hauteur du caneva du jeu </span></span> — <span lang="fr"><span> elles nous aideront à positionner les éléments à l'écran.</span> <span>Nous chargeons d'abord deux images qui seront utilisées plus tard dans l'état <code>Preload</code> <em>(préchargement)</em> pour montrer la progression du chargement de tous les autres éléments.</span> <span>La fonction <code>create</code> contient une configuration de base : nous configurons la mise à l'échelle et l'alignement du canevas et passons à l'état</span></span> <code>Preload</code> <span lang="fr"><span> lorsque tout est prêt.</span></span></p>

<h3 id="Preloader.js_(préchargement)">Preloader.js <em>(préchargement)</em></h3>

<p>L'état <code>Preloader</code> <span class="short_text" id="result_box" lang="fr"><span>prend soin de charger tous les éléments</span></span> :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">Ball<span class="punctuation token">.</span>Preloader <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span>game<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>Preloader<span class="punctuation token">.</span>prototype <span class="operator token">=</span> <span class="punctuation token">{</span>
    preload<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>preloadBg <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">sprite</span><span class="punctuation token">(</span><span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_WIDTH<span class="number token">-297</span><span class="punctuation token">)</span><span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_HEIGHT<span class="number token">-145</span><span class="punctuation token">)</span><span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="string token">'preloaderBg'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>preloadBar <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">sprite</span><span class="punctuation token">(</span><span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_WIDTH<span class="number token">-158</span><span class="punctuation token">)</span><span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_HEIGHT<span class="number token">-50</span><span class="punctuation token">)</span><span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="string token">'preloaderBar'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">setPreloadSprite</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>preloadBar<span class="punctuation token">)</span><span class="punctuation token">;</span>

        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">image</span><span class="punctuation token">(</span><span class="string token">'ball'</span><span class="punctuation token">,</span> <span class="string token">'img/ball.png'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="comment token">// ...</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">spritesheet</span><span class="punctuation token">(</span><span class="string token">'button-start'</span><span class="punctuation token">,</span> <span class="string token">'img/button-start.png'</span><span class="punctuation token">,</span> <span class="number token">146</span><span class="punctuation token">,</span> <span class="number token">51</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="comment token">// ...</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>load<span class="punctuation token">.</span><span class="function token">audio</span><span class="punctuation token">(</span><span class="string token">'audio-bounce'</span><span class="punctuation token">,</span> <span class="punctuation token">[</span><span class="string token">'audio/bounce.ogg'</span><span class="punctuation token">,</span> <span class="string token">'audio/bounce.mp3'</span><span class="punctuation token">,</span> <span class="string token">'audio/bounce.m4a'</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span><span class="punctuation token">,</span>
    create<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'MainMenu'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Il y a des images uniques, des feuilles de "sprites" et des fichiers audio chargés par le "framework".</span> <span>Dans cet état, la <code>preloadBar</code> <em>(barre du préchargement)</em> affiche la progression à l'écran.</span> <span>Cette progression des éléments chargés est visualisée par le framework avec l'utilisation d'une image.</span> <span>Avec chaque élément chargé, vous pouvez voir plus de l'image <code>preloadBar</code>: de 0% à 100%, mis à jour sur chaque image.</span> <span>Une fois que tous les éléments sont chargés, l'état MainMenu est lancé.</span></span></p>

<h3 id="MainMenu.js_(menu_principal)">MainMenu.js <em>(menu principal)</em></h3>

<p>L'état <code>MainMenu</code> montre le menu principal du jeu, sur lequel vous pouvez lancer le jeu en cliquant sur le bouton.</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">Ball<span class="punctuation token">.</span>MainMenu <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span>game<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>MainMenu<span class="punctuation token">.</span>prototype <span class="operator token">=</span> <span class="punctuation token">{</span>
    create<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">sprite</span><span class="punctuation token">(</span><span class="number token">0</span><span class="punctuation token">,</span> <span class="number token">0</span><span class="punctuation token">,</span> <span class="string token">'screen-mainmenu'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>gameTitle <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">sprite</span><span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_WIDTH<span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="number token">40</span><span class="punctuation token">,</span> <span class="string token">'title'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>gameTitle<span class="punctuation token">.</span>anchor<span class="punctuation token">.</span><span class="keyword token">set</span><span class="punctuation token">(</span><span class="number token">0.5</span><span class="punctuation token">,</span><span class="number token">0</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>startButton <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">button</span><span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_WIDTH<span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="number token">200</span><span class="punctuation token">,</span> <span class="string token">'button-start'</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>startGame<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">,</span> <span class="number token">2</span><span class="punctuation token">,</span> <span class="number token">0</span><span class="punctuation token">,</span> <span class="number token">1</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>startButton<span class="punctuation token">.</span>anchor<span class="punctuation token">.</span><span class="keyword token">set</span><span class="punctuation token">(</span><span class="number token">0.5</span><span class="punctuation token">,</span><span class="number token">0</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>startButton<span class="punctuation token">.</span>input<span class="punctuation token">.</span>useHandCursor <span class="operator token">=</span> <span class="keyword token">true</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span><span class="punctuation token">,</span>
    startGame<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'Howto'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span></code></pre>

<p>Pour créer un nouveau bouton, il y a la méthode <code>add.button</code> avec la liste suivante d'arguments facultatifs :</p>

<ul>
 <li>position absolue supérieure sur Canvas en pixels.</li>
 <li>position gauche absolue sur Canvas en pixels.</li>
 <li>nom de l'élément image utilisé par le bouton.</li>
 <li>fonction qui doit être exécutée quand quelqu'un clique sur le bouton.</li>
 <li>le contexte d'exécution.</li>
 <li>cadre <span id="result_box" lang="fr"><span> de l'objet image utilisé comme état du bouton "hover" <em>(flottant)</em></span></span> .</li>
 <li>cadre<span id="result_box" lang="fr"><span> de l'objet image utilisé comme état du bouton</span></span> "normal" ou "out" <em>(en dehors)</em>.</li>
 <li>cadre<span id="result_box" lang="fr"><span> de l'objet image utilisé comme état du bouton</span></span> "click" ou "down" (<em>en bas</em>).</li>
</ul>

<p><span id="result_box" lang="fr"><span><code>Anchor.set</code> configure le point d'ancrage du bouton sur lequel tous les calculs de la position sont appliqués.</span> <span>Dans notre cas, il est ancré à mi-chemin du bord gauche et au début du bord supérieur, de sorte qu'il peut être facilement centré horizontalement sur l'écran sans avoir besoin de connaître sa largeur.</span></span></p>

<p><span id="result_box" lang="fr"><span>Lorsque le bouton de démarrage est enfoncé, au lieu de sauter directement dans l'action, le jeu affichera l'écran avec les informations sur la façon de jouer.</span></span></p>

<h3 id="Howto.js_(comment_jouer)">Howto.js <em>(comment jouer)</em></h3>

<pre class="brush: js line-numbers  language-js"><code class="language-js">Ball<span class="punctuation token">.</span>Howto <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span>game<span class="punctuation token">)</span> <span class="punctuation token">{</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>Howto<span class="punctuation token">.</span>prototype <span class="operator token">=</span> <span class="punctuation token">{</span>
    create<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>buttonContinue <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">button</span><span class="punctuation token">(</span><span class="number token">0</span><span class="punctuation token">,</span> <span class="number token">0</span><span class="punctuation token">,</span> <span class="string token">'screen-howtoplay'</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>startGame<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span><span class="punctuation token">,</span>
    startGame<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'Game'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>L'état <code>Howto</code> affiche les instructions du jeu à l'écran avant de commencer le jeu.</span> <span>Après avoir cliqué sur l'écran, le jeu réel est lancé.</span></span></p>

<h3 id="Game.js_(jeu)">Game.js (jeu)</h3>

<p><span id="result_box" lang="fr"><span>L'état <code>game</code> à partir du fichier <code>Game.js</code> est le lieu où toute la magie opère.</span> <span>Toute l'initialisation est dans la fonction <code>create ()</code> (lancée une fois au début du jeu).</span> <span>Après cela, certaines fonctionnalités nécessiteront d'autres codes à contrôler </span></span> — <span lang="fr"><span> nous écrirons nos propres fonctions pour gérer des tâches plus complexes.</span> <span>En particulier, notez  la fonction <code>update ()</code> exécutée à chaque frame, qui met à jour des choses telles que la position de la balle.</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">Ball<span class="punctuation token">.</span>Game <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span>game<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>
Ball<span class="punctuation token">.</span>Game<span class="punctuation token">.</span>prototype <span class="operator token">=</span> <span class="punctuation token">{</span>
    create<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    initLevels<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    showLevel<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span>level<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    updateCounter<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    managePause<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    manageAudio<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    update<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    wallCollision<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    handleOrientation<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">,</span>
    finishLevel<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">;</span></code></pre>

<p>Les fonctions <code>create</code> et <code>update</code> sont spécifiques au framework, tandis que d'autres seront nos créations :</p>

<ul>
 <li><code>initLevels</code> initialise les données de niveau.</li>
 <li><code>showLevel</code> affiche à l'écran les données du niveau.</li>
 <li><code>updateCounter</code> <span id="result_box" lang="fr"><span>met à jour le temps passé à jouer chaque niveau et enregistre le temps total passé à jouer sur le jeu.</span></span> </li>
 <li><code>managePause</code> met en pause et reprend le jeu.</li>
 <li><code>manageAudio</code> allume et éteint le son.</li>
 <li><code>wallCollision</code> est exécuté quand la balle frappe les murs ou d'autres objets.</li>
 <li><code>handleOrientation</code> <span id="result_box" lang="fr"><span>est la fonction liée à l'événement responsable de l'API d'orientation des périphériques, fournissant les contrôles de mouvement lorsque le jeu est en cours d'exécution sur un périphérique mobile avec le matériel approprié.</span></span></li>
 <li><code>finishLevel</code> <span id="result_box" lang="fr"><span>charge un nouveau niveau lorsque le niveau actuel est terminé ou termine le jeu si le niveau final est terminé.</span></span></li>
</ul>

<h3 id="Ajout_de_la_balle_et_de_ses_mécanismes_de_mouvement">Ajout de la balle et de ses mécanismes de mouvement</h3>

<p>D'abord, dans la fonction <code>create</code>, initialisons l'objet '<code>ball</code>' et assignons lui quelques propriétés :</p>

<pre class="brush: js">ball = this.add.sprite((320-22)/2, 450, 'ball');
ball.anchor.setTo(0.5, 0.5);
ball.body.bounce.setTo(0.3, 0.3);
ball.body.setCircle(10, 11, 11);
ball.body.linearDamping = 1;</pre>

<p>On ajoute un "sprite" à une place donnée sur l'écran en utilisant l'image <code>'ball'</code>. On ajoute aussi le point de repère de tous les calculs physiques ( '<code>anchor</code>' ) au milieu de la balle,  <span id="result_box" lang="fr"><span>permettant au moteur physique d'arcade (qui gère toute la physique du mouvement de la balle)</span></span> <span id="result_box" lang="fr"><span>et en définissant la taille du corps pour la détection de collision</span></span> . <span id="result_box" lang="fr"><span>La propriété </span></span> <code>bounce</code><span lang="fr"><span> est utilisée pour définir le rebondissement de la balle quand elle frappe les obstacles.</span></span></p>

<h3 id="Contrôle_de_la_balle">Contrôle de la balle</h3>

<p>C'est déjà sympa d'avoir une balle prête à être lancée dans la zone de jeu, mais c'est aussi important de pouvoir le faire. Maintenant on va ajouter la possibilité de contrôler la balle avec le clavier sur les ordinateurs, et ensuite on ajoutera l'implémentation de l'API  Device Orientation ( <em>gyroscope</em>). Maintenant, concentrons-nous sur le clavier en ajoutant la ligne suivante pour la fonction <code>create()</code> :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>keys <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>input<span class="punctuation token">.</span>keyboard<span class="punctuation token">.</span><span class="function token">createCursorKeys</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>Comme vous pouvez le voir, Phaser a une fonction spéciale  <code>createCursorKeys()</code> <span id="result_box" lang="fr"><span>qui nous donnera un objet avec des gestionnaires d'événements pour les quatre touches fléchées : haut, bas, gauche et droite.</span></span> </p>

<p><span id="result_box" lang="fr"><span>Ensuite, nous allons ajouter le code suivant dans la fonction <code>update ()</code>, il sera lancé à chaque "frame".</span></span> L'objet <code>this.keys</code> sera vérifié aux pressions de touche du joueur, la balle réagira donc en conséquence :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>keys<span class="punctuation token">.</span>left<span class="punctuation token">.</span>isDown<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>x <span class="operator token">-</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>movementForce<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
<span class="keyword token">else</span> <span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>keys<span class="punctuation token">.</span>right<span class="punctuation token">.</span>isDown<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>x <span class="operator token">+</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>movementForce<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
<span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>keys<span class="punctuation token">.</span>up<span class="punctuation token">.</span>isDown<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>y <span class="operator token">-</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>movementForce<span class="punctuation token">;</span>
<span class="punctuation token">}</span>
<span class="keyword token">else</span> <span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>keys<span class="punctuation token">.</span>down<span class="punctuation token">.</span>isDown<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>y <span class="operator token">+</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>movementForce<span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p>De cette manière on peut vérifier quelle touche est pressée à un moment donné et appliquer une force définie à la balle, ce qui a pour effet d'augmenter sa vélocité dans la bonne direction.</p>

<h2 id="Implémentation_de_l'API_Device_Orientation_(gyroscopique)">Implémentation de l'API Device Orientation (<em>gyroscopique</em>)</h2>

<p>La particularité du jeu est qu'il utilise l'API gyroscopique sur les mobiles. Grâce à elle, vous pouvez jouer au jeu en inclinant l'appareil dans la direction où vous voulez que la balle aille. Voilà le code de la fonction  <code>create()</code> qui l'implémente :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"deviceorientation"</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>handleOrientation<span class="punctuation token">,</span> <span class="keyword token">true</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>L'ajout d'un évènement "listener" à l'évenement <code>"deviceorientation"</code> et la modification de la fonction <code>handleOrientation</code>ressembleront à ceci :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">handleOrientation<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> x <span class="operator token">=</span> e<span class="punctuation token">.</span>gamma<span class="punctuation token">;</span>
    <span class="keyword token">var</span> y <span class="operator token">=</span> e<span class="punctuation token">.</span>beta<span class="punctuation token">;</span>
    Ball<span class="punctuation token">.</span>_player<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>x <span class="operator token">+</span><span class="operator token">=</span> x<span class="punctuation token">;</span>
    Ball<span class="punctuation token">.</span>_player<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>y <span class="operator token">+</span><span class="operator token">=</span> y<span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p>Plus l'appareil est incliné, plus la force appliquée à la balle et sa vélocité sont importantes.</p>

<p><img alt="An explanation of the X, Y and Z axes of a Flame mobile device with the Cyber Orb game demo on the screen." src="https://mdn.mozillademos.org/files/10369/cyber-orb-flame-orientation.png" style="height: 480px; width: 620px;"></p>

<div class="note">
<p><strong>Note</strong>: <span id="result_box" lang="fr"><span>Pour en savoir plus sur l'implémentation de l'orientation du périphérique et sur le code brut, lisez</span></span> <a href="https://developer.mozilla.org/en-US/Apps/Build/gather_and_modify_data/responding_to_device_orientation_changes">Gardez-le au niveau : en réponse aux changements d'orientation du périphérique</a>. </p>
</div>

<h3 id="Ajout_du_trou">Ajout du trou</h3>

<p>L'objectif principal du jeu est de déplacer la balle du point de départ vers le point d'arrivée, qui est dans notre cas, un trou dans le sol. L'implémentation ressemble beaucoup à celle de la création de la balle et est ajoutée dans la fonction <code>create()</code> de l'état <code>Game</code> :</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>hole <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">sprite</span><span class="punctuation token">(</span>Ball<span class="punctuation token">.</span>_WIDTH<span class="operator token">*</span><span class="number token">0.5</span><span class="punctuation token">,</span> <span class="number token">90</span><span class="punctuation token">,</span> <span class="string token">'hole'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>physics<span class="punctuation token">.</span><span class="function token">enable</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>hole<span class="punctuation token">,</span> Phaser<span class="punctuation token">.</span>Physics<span class="punctuation token">.</span>ARCADE<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>hole<span class="punctuation token">.</span>anchor<span class="punctuation token">.</span><span class="keyword token">set</span><span class="punctuation token">(</span><span class="number token">0.5</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>hole<span class="punctuation token">.</span>body<span class="punctuation token">.</span><span class="function token">setSize</span><span class="punctuation token">(</span><span class="number token">2</span><span class="punctuation token">,</span> <span class="number token">2</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>La seule différence est que '<code>hole.body</code>' est mis à <code>immovable</code><em>(fixe)</em>, il ne bougera donc pas quand la balle le touchera et la collision sera alors calculée ( ce point sera approfondit plus loin dans cet article ).</p>

<h3 id="Création_du_mur_du_labyrinthe">Création du mur du labyrinthe</h3>

<p><span id="result_box" lang="fr"><span>Pour rendre le jeu plus difficile et plus intéressant, nous allons ajouter des obstacles entre la balle et la sortie.</span> <span>Nous pourrions utiliser un éditeur de niveau, mais pour ce tutoriel, créons quelque chose par nous-mêmes.</span></span></p>

<p><span id="result_box" lang="fr"><span>Pour conserver les informations du bloc, nous utiliserons un tableau de données de niveau : pour chaque bloc, nous stockons les positions absolues supérieure et gauche en pixels (<code>x</code> et <code>y</code>) et le type du bloc - horizontal ou vertical (<code>t</code> avec le '<code>w</code></span> <span>'valeur signifiant largeur et' <code>h</code> 'signifiant hauteur).</span> <span>Ensuite, pour charger le niveau, nous allons analyser les données et afficher les blocs spécifiques à ce niveau.</span> <span>Dans la fonction <code>initLevels</code>, nous avons :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>levelData <span class="operator token">=</span> <span class="punctuation token">[</span>
    <span class="punctuation token">[</span>
        <span class="punctuation token">{</span> x<span class="punctuation token">:</span> <span class="number token">96</span><span class="punctuation token">,</span> y<span class="punctuation token">:</span> <span class="number token">224</span><span class="punctuation token">,</span> t<span class="punctuation token">:</span> <span class="string token">'w'</span> <span class="punctuation token">}</span>
    <span class="punctuation token">]</span><span class="punctuation token">,</span>
    <span class="punctuation token">[</span>
        <span class="punctuation token">{</span> x<span class="punctuation token">:</span> <span class="number token">72</span><span class="punctuation token">,</span> y<span class="punctuation token">:</span> <span class="number token">320</span><span class="punctuation token">,</span> t<span class="punctuation token">:</span> <span class="string token">'w'</span> <span class="punctuation token">}</span><span class="punctuation token">,</span>
        <span class="punctuation token">{</span> x<span class="punctuation token">:</span> <span class="number token">200</span><span class="punctuation token">,</span> y<span class="punctuation token">:</span> <span class="number token">320</span><span class="punctuation token">,</span> t<span class="punctuation token">:</span> <span class="string token">'h'</span> <span class="punctuation token">}</span><span class="punctuation token">,</span>
        <span class="punctuation token">{</span> x<span class="punctuation token">:</span> <span class="number token">72</span><span class="punctuation token">,</span> y<span class="punctuation token">:</span> <span class="number token">150</span><span class="punctuation token">,</span> t<span class="punctuation token">:</span> <span class="string token">'w'</span> <span class="punctuation token">}</span>
    <span class="punctuation token">]</span><span class="punctuation token">,</span>
    <span class="comment token">// ...</span>
<span class="punctuation token">]</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Chaque élément de tableau contient une collection de blocs avec une position <code>x</code> et <code>y</code> et une valeur <code>t</code> pour chacun.</span> <span>Après <code>levelData</code>, mais toujours dans la fonction <code>initLevels</code>, nous ajoutons les blocs dans un tableau de la boucle <code>for</code> en utilisant certaines des méthodes spécifiques au framework :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">for</span><span class="punctuation token">(</span><span class="keyword token">var</span> i<span class="operator token">=</span><span class="number token">0</span><span class="punctuation token">;</span> i<span class="operator token">&lt;</span><span class="keyword token">this</span><span class="punctuation token">.</span>maxLevels<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> newLevel <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">group</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    newLevel<span class="punctuation token">.</span>enableBody <span class="operator token">=</span> <span class="keyword token">true</span><span class="punctuation token">;</span>
    newLevel<span class="punctuation token">.</span>physicsBodyType <span class="operator token">=</span> Phaser<span class="punctuation token">.</span>Physics<span class="punctuation token">.</span>ARCADE<span class="punctuation token">;</span>
    <span class="keyword token">for</span><span class="punctuation token">(</span><span class="keyword token">var</span> e<span class="operator token">=</span><span class="number token">0</span><span class="punctuation token">;</span> e<span class="operator token">&lt;</span><span class="keyword token">this</span><span class="punctuation token">.</span>levelData<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span>length<span class="punctuation token">;</span> e<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">var</span> item <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>levelData<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">[</span>e<span class="punctuation token">]</span><span class="punctuation token">;</span>
        newLevel<span class="punctuation token">.</span><span class="function token">create</span><span class="punctuation token">(</span>item<span class="punctuation token">.</span>x<span class="punctuation token">,</span> item<span class="punctuation token">.</span>y<span class="punctuation token">,</span> <span class="string token">'element-'</span><span class="operator token">+</span>item<span class="punctuation token">.</span>t<span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
    newLevel<span class="punctuation token">.</span><span class="function token">setAll</span><span class="punctuation token">(</span><span class="string token">'body.immovable'</span><span class="punctuation token">,</span> <span class="keyword token">true</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    newLevel<span class="punctuation token">.</span>visible <span class="operator token">=</span> <span class="keyword token">false</span><span class="punctuation token">;</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>levels<span class="punctuation token">.</span><span class="function token">push</span><span class="punctuation token">(</span>newLevel<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p><span id="result_box" lang="fr"><span>Tout d'abord, <code>add.group ()</code> est utilisé pour créer un nouveau groupe d'éléments.</span> <span>Ensuite, le type de corps <code>ARCADE</code> est défini pour ce groupe pour activer les calculs physiques.</span> <span>La méthode <code>newLevel.create</code> crée de nouveaux éléments dans le groupe avec les positions de départ haut et gauche et sa propre image.</span> <span>Si vous ne souhaitez pas parcourir à nouveau la liste des éléments pour ajouter explicitement une propriété à chacun d'eux, vous pouvez utiliser <code>setAll</code> sur un groupe pour l'appliquer à tous les éléments de ce groupe.</span><br>
 <br>
 <span>Les objets sont stockés dans le tableau <code>this.levels</code>, qui est ,par défaut, invisible.</span> <span>Pour charger des niveaux spécifiques, nous nous assurons que les niveaux précédents sont cachés et affichent le niveau actuel :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">showLevel<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span>level<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> lvl <span class="operator token">=</span> level <span class="operator token">|</span> <span class="keyword token">this</span><span class="punctuation token">.</span>level<span class="punctuation token">;</span>
    <span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>levels<span class="punctuation token">[</span>lvl<span class="number token">-2</span><span class="punctuation token">]</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>levels<span class="punctuation token">[</span>lvl<span class="number token">-2</span><span class="punctuation token">]</span><span class="punctuation token">.</span>visible <span class="operator token">=</span> <span class="keyword token">false</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>levels<span class="punctuation token">[</span>lvl<span class="number token">-1</span><span class="punctuation token">]</span><span class="punctuation token">.</span>visible <span class="operator token">=</span> <span class="keyword token">true</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p><span id="result_box" lang="fr"><span>Grâce à cela, le jeu donne au joueur un défi : il doit maintenant rouler la balle à travers l'aire de jeu et la guider dans le labyrinthe construit à partir des blocs.</span> <span>C'est juste un exemple de chargement des niveaux, et il n'y a que 5, juste pour présenter l'idée, mais vous pouvez travailler à l'étendre par vous-même.</span></span></p>

<h3 id="Détection_de_collision">Détection de collision</h3>

<p><span id="result_box" lang="fr"><span>À ce stade, nous avons la balle qui est contrôlée par le joueur, le trou à atteindre et les obstacles qui bloquent la route.</span> <span>Il y a un problème cependant : notre jeu n'a pas encore de détection de collision, donc il ne se passe rien quand la balle frappe les blocs, elle passe juste à travers.</span> <span>Réparons-le !</span> <span>Les bonnes nouvelles sont que le cadre se chargera de calculer la détection de collision, il suffit de spécifier les objets en collision dans la fonction <code>update ()</code> :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>physics<span class="punctuation token">.</span>arcade<span class="punctuation token">.</span><span class="function token">collide</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>borderGroup<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>wallCollision<span class="punctuation token">,</span> <span class="keyword token">null</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>physics<span class="punctuation token">.</span>arcade<span class="punctuation token">.</span><span class="function token">collide</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>levels<span class="punctuation token">[</span><span class="keyword token">this</span><span class="punctuation token">.</span>level<span class="number token">-1</span><span class="punctuation token">]</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>wallCollision<span class="punctuation token">,</span> <span class="keyword token">null</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Cela dira à la structure d'exécuter la fonction <code>wallCollision</code> lorsque la balle frappe l'un des murs.</span> <span>Nous pouvons utiliser la fonction <code>wallCollision</code> pour ajouter toutes les fonctionnalités que nous voulons comme jouer le son du rebondissement et implémenter l'API Vibration.</span></span></p>

<h4 id="Ajout_de_son">Ajout de son</h4>

<p><span id="result_box" lang="fr"><span>Parmi les éléments préchargés, il y avait une piste audio (dans différents formats pour la compatibilité avec les navigateurs), que nous pouvons utiliser maintenant.</span> <span>Il doit d'abord être défini dans la fonction <code>create ()</code> :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>bounceSound <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">audio</span><span class="punctuation token">(</span><span class="string token">'audio-bounce'</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Si l'état de l'audio est <code>true</code> <em>(vrai)</em> (les sons du jeu sont activés), nous pouvons le jouer dans la fonction <code>wallCollision</code>:</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>audioStatus<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>bounceSound<span class="punctuation token">.</span><span class="function token">play</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p><span id="result_box" lang="fr"><span>C'est tout - charger et jouer les sons est facile avec Phaser.</span></span></p>

<h4 id="Implementing_the_Vibration_API">Implementing the Vibration API</h4>

<p><span id="result_box" lang="fr"><span>Lorsque la détection de collision fonctionne comme prévu, ajoutons quelques effets spéciaux avec l'aide de l'API Vibration.</span></span></p>

<p><img alt="A visualization of the vibrations of a Flame mobile device with the Cyber Orb game demo on the screen." src="https://mdn.mozillademos.org/files/10371/cyber-orb-flame-vibration.png" style="height: 480px; width: 620px;"></p>

<p><span id="result_box" lang="fr"><span>La meilleure façon de l'utiliser dans notre cas est de faire vibrer le téléphone chaque fois que la balle frappe les murs, à l'intérieur de la fonction <code>wallCollision</code> :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">if</span><span class="punctuation token">(</span><span class="string token">"vibrate"</span> <span class="keyword token">in</span> window<span class="punctuation token">.</span>navigator<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    window<span class="punctuation token">.</span>navigator<span class="punctuation token">.</span><span class="function token">vibrate</span><span class="punctuation token">(</span><span class="number token">100</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<p><span id="result_box" lang="fr"><span>Si la méthode <code>vibrate</code> est prise en charge par le navigateur et disponible dans l'objet <code>window.navigator</code>, faites vibrer le téléphone pendant 100 millisecondes.</span> <span>C'est tout !</span></span></p>

<h3 id="Ajout_du_temps_écoulé"><span class="short_text" id="result_box" lang="fr"><span>Ajout du temps écoulé</span></span></h3>

<p><span id="result_box" lang="fr"><span>Pour améliorer la rejouabilité et donner aux joueurs l'option de rivaliser les uns avec les autres, nous pouvons introduire le temps écoulé.</span> <span>Grâce à cela, le joueur peut jouer les niveaux encore et encore en essayant d'améliorer son score.</span> <span>Pour implémenter cela dans le jeu, nous devons créer une variable pour stocker le nombre réel de secondes écoulées depuis le début du jeu et le montrer au joueur dans le jeu.</span> <span>Définissons d'abord la variable :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>timer <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> <span class="comment token">// time elapsed in the current level</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> <span class="comment token">// time elapsed in the whole game</span></code></pre>

<p><span id="result_box" lang="fr"><span>Ensuite, juste après, nous pouvons initialiser les objets texte nécessaires à l'affichage de cette information pour l'utilisateur:</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>timerText <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">text</span><span class="punctuation token">(</span><span class="number token">15</span><span class="punctuation token">,</span> <span class="number token">15</span><span class="punctuation token">,</span> <span class="string token">"Time: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>fontBig<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">this</span><span class="punctuation token">.</span>totalTimeText <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>add<span class="punctuation token">.</span><span class="function token">text</span><span class="punctuation token">(</span><span class="number token">120</span><span class="punctuation token">,</span> <span class="number token">30</span><span class="punctuation token">,</span> <span class="string token">"Total time: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>fontSmall<span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Nous définissons les positions supérieure et gauche du texte, le contenu qui sera affiché et le style appliqué au texte.</span> <span>Nous l'avons imprimé à l'écran, mais il serait bon de mettre à jour les valeurs toutes les secondes :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>time<span class="punctuation token">.</span>events<span class="punctuation token">.</span><span class="function token">loop</span><span class="punctuation token">(</span>Phaser<span class="punctuation token">.</span>Timer<span class="punctuation token">.</span>SECOND<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>updateCounter<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Cette boucle, également dans la fonction </span></span> <code>create</code> <span lang="fr"><span>, exécutera la fonction <code>updateCounter</code> à chaque seconde du début du jeu afin que nous puissions appliquer les modifications en conséquence.</span> <span>Voici à quoi ressemble la fonction <code>updateCounter</code> complète :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">updateCounter<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="operator token">++</span><span class="punctuation token">;</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>timerText<span class="punctuation token">.</span><span class="function token">setText</span><span class="punctuation token">(</span><span class="string token">"Time: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span>totalTimeText<span class="punctuation token">.</span><span class="function token">setText</span><span class="punctuation token">(</span><span class="string token">"Total time: "</span><span class="operator token">+</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer<span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">,</span></code></pre>

<p><span id="result_box" lang="fr"><span>Comme vous pouvez le voir, nous incrémentons la variable <code>this.timer</code> et mettons à jour le contenu des objets texte avec les valeurs actuelles à chaque itération, de sorte que le joueur voit le temps écoulé.</span></span></p>

<h3 id="Finition_du_niveau_et_du_jeu">Finition du niveau et du jeu</h3>

<p><span id="result_box" lang="fr"><span>La balle tourne sur l'écran, le minutage fonctionne et nous avons le trou créé que nous devons atteindre.</span> <span>Maintenant, mettons en place la possibilité de finir le niveau !</span> <span>La ligne suivante de la fonction <code>update ()</code> ajoute un écouteur qui se déclenche lorsque la balle arrive au trou.</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">this</span><span class="punctuation token">.</span>physics<span class="punctuation token">.</span>arcade<span class="punctuation token">.</span><span class="function token">overlap</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>hole<span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">.</span>finishLevel<span class="punctuation token">,</span> <span class="keyword token">null</span><span class="punctuation token">,</span> <span class="keyword token">this</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="fr"><span>Cela fonctionne de la même manière que la méthode <code>collide</code> expliquée précédemment.</span> <span>Lorsque la balle chevauche le trou (au lieu de collision), la fonction <code>finishLevel</code> est exécutée :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">finishLevel<span class="punctuation token">:</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">if</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>level <span class="operator token">&gt;=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>maxLevels<span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer <span class="operator token">+</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">;</span>
        <span class="function token">alert</span><span class="punctuation token">(</span><span class="string token">'Congratulations, game completed!\nTotal time of play: '</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer<span class="operator token">+</span><span class="string token">' seconds!'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>game<span class="punctuation token">.</span>state<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="string token">'MainMenu'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
    <span class="keyword token">else</span> <span class="punctuation token">{</span>
        <span class="function token">alert</span><span class="punctuation token">(</span><span class="string token">'Congratulations, level '</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>level<span class="operator token">+</span><span class="string token">' completed!'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer <span class="operator token">+</span><span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>timer <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>level<span class="operator token">++</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>timerText<span class="punctuation token">.</span><span class="function token">setText</span><span class="punctuation token">(</span><span class="string token">"Time: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>timer<span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>totalTimeText<span class="punctuation token">.</span><span class="function token">setText</span><span class="punctuation token">(</span><span class="string token">"Total time: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>totalTimer<span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>levelText<span class="punctuation token">.</span><span class="function token">setText</span><span class="punctuation token">(</span><span class="string token">"Level: "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>level<span class="operator token">+</span><span class="string token">" / "</span><span class="operator token">+</span><span class="keyword token">this</span><span class="punctuation token">.</span>maxLevels<span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>x <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ballStartPos<span class="punctuation token">.</span>x<span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>y <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ballStartPos<span class="punctuation token">.</span>y<span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>x <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span>ball<span class="punctuation token">.</span>body<span class="punctuation token">.</span>velocity<span class="punctuation token">.</span>y <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
        <span class="keyword token">this</span><span class="punctuation token">.</span><span class="function token">showLevel</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">,</span></code></pre>

<p><span id="result_box" lang="fr"><span>Si le niveau actuel est égal au nombre maximum de niveaux (dans ce cas, 5), le jeu est terminé - vous recevrez un message de félicitations avec le nombre de secondes écoulées pendant toute la partie et un clique sur un bouton</span> <span>vous ramène au menu principal.</span></span></p>

<p><span id="result_box" lang="fr"><span>Si le niveau actuel est inférieur à 5, toutes les variables nécessaires sont réinitialisées et le niveau suivant est chargé.</span></span></p>

<h2 id="Idées_pour_de_nouvelles_fonctionnalités">Idées pour de nouvelles fonctionnalités</h2>

<p><span id="result_box" lang="fr"><span>Ceci est simplement une démonstration de travail d'un jeu qui pourrait avoir beaucoup de fonctionnalités supplémentaires.</span> <span>Nous pouvons par exemple ajouter des "power-ups" à collecter en cours de route qui feront rouler notre balle plus rapidement, arrêter le chronomètre pendant quelques secondes ou donner à la balle des pouvoirs spéciaux pour traverser les obstacles.</span> <span>Il y a aussi de la place pour les pièges qui ralentiront la balle ou rendront le but plus difficile à atteindre.</span> <span>Vous pouvez créer plus de niveaux de difficulté croissante.</span> <span>Vous pouvez même mettre en œuvre des trophées, des classements et des médailles pour différentes actions du jeu.</span> <span>Il y a des possibilités infinies - elles ne dépendent que de votre imagination.</span></span></p>

<h2 id="Résumé">Résumé</h2>

<p><span id="result_box" lang="fr"><span>J'espère que ce tutoriel vous aidera à plonger dans le développement de jeux en 2D et vous inspirera pour créer des jeux géniaux par vous-même.</span> <span>Vous pouvez jouer au jeu de démonstration</span></span> <a href="http://orb.enclavegames.com/">Cyber Orb</a> et <span class="short_text" id="result_box" lang="fr"><span>consulter son</span></span> <a href="https://github.com/EnclaveGames/Cyber-Orb">code source sur GitHub</a>.</p>

<p><span id="result_box" lang="fr"><span>HTML5 nous donne des outils bruts, les frameworks construits au-dessus deviennent plus rapides et meilleurs, alors c'est un bon moment pour le développement de jeux web.</span> <span>Dans ce tutoriel, nous avons utilisé Phaser, mais il existe un certain nombre d'</span></span> <a href="http://html5devstarter.enclavegames.com/#frameworks">autres frameworks</a> <span class="short_text" id="result_box" lang="fr"><span>qui méritent d'être considérés aussi, comme</span></span> <a href="http://impactjs.com/">ImpactJS</a>, <a href="https://www.scirra.com/construct2">Construct 2</a> ou <a href="http://playcanvas.com/">PlayCanvas</a> — <span id="result_box" lang="fr"><span>cela dépend de vos préférences, de vos compétences en codage (ou de leur absence), de l'échelle du projet, des exigences et d'autres aspects.</span> <span>Vous devriez les regarder tous et décider lequel convient le mieux à vos besoins.</span></span></p>
