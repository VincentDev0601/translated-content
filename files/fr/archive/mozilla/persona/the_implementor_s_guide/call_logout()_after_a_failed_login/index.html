---
title: Appeler logout() après une connexion échouée
slug: >-
  Archive/Mozilla/Persona/The_implementor_s_guide/Call_logout()_after_a_failed_login
tags:
  - Persona
translation_of: >-
  Archive/Mozilla/Persona/The_implementor_s_guide/Call_logout()_after_a_failed_login
---
<p>Après que votre gestionnaire <code>onlogin</code> a été appelé avec une assertion, si pour quelque raison, vous ne pouvez utiliser cette assertion pour connecter l'utilisateur, vous devez appeler <a href="/fr/docs/Web/API/Navigator/id/logout" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.logout()</code></a>.</p>
<p>Si vous ne le faîtes pas, la prochaine que vous appelerez <a href="/fr/docs/Web/API/Navigator/id/watch" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.watch()</code></a>, Persona appelera immédiatement, à nouveau, votre gestionnaire <code>onlogin</code>, avec la même assertion. Ceci amène généralement à une boucle infinie d'echec de connexion :</p>
<ol>
 <li>L'utilisateur clique sur "Se connecter"</li>
 <li>L'utilisateur intéragit avec l'interface de Persona, et Persona génère une assertion</li>
 <li>Persona livre l'assertion au gestionnaire <code>onlogin</code> de la page</li>
 <li>Le gestionnaire <code>onlogin</code> rejète l'assertion, et redirige l'utilisateur vers la page de connexion</li>
 <li>La page de connexion se charge, et appelle <a href="/fr/docs/Web/API/Navigator/id/watch" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.watch()</code></a>. Nous retournons à l'étape 3.</li>
</ol>
<p>Ceci car Persona essaye de se souvenir de l'adresse e-mail que vous voulez utilisez pour la connexion sur un site donné. Une fois que l'utilisateur a essayé de se connecté à votre site en tant que bob@example.org, Personna se souvient que c'est l'adresse que vous souhaitez utiliser pour ce site. Quand une nouvelle page se charge et appele <a href="/fr/docs/Web/API/Navigator/id/watch" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.watch()</code></a> avec un <code>loggedInUser</code> à '<code>null</code>', Persona compare à nouveau avec sa valeur "bob@example.org", et envoie l'assertion à nouveau.</p>
<p>Pour que Persona oublie l'association entre votre site l'adresse e-mail, appelez <a href="/fr/docs/Web/API/Navigator/id/logout" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.logout()</code></a> si vous ne souhaitez pas identifier l'utilisateur avec cette assertion. Ceci parce que l'assertion n'est pas valide, ou parce que vous ne voulez pas utiliser cette adresse e-mail.</p>
<p>Un scénario commun, où ce problème peut survenir, est quand un service veut autoriser ses utilisateurs à <strong>se connecter</strong> avec Persona, mais ne veut pas permettre de <strong>s'inscrire</strong> avec Persona, préférant un système d'inscription personnalisé pour les nouveaux utilisateurs. Dans ce cas, quand vous recevez l'assertion, vous vérifiez que l'adresse e-mail est bien celui d'un de vos utilisateurs, et si ce n'est pas le cas, vous rejetez la connexion. Si vous rejetez l'assertion, vous devez appeler <a href="/fr/docs/Web/API/Navigator/id/logout" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>navigator.id.logout()</code></a>.</p>
