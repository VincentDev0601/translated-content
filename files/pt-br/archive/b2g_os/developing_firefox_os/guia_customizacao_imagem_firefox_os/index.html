---
title: Guia de customização comercial do Firefox OS
slug: Archive/B2G_OS/Developing_Firefox_OS/Guia_customizacao_imagem_Firefox_OS
tags:
  - Customização Imagem
  - Desenvolvimento
  - Firefox OS
  - Gaia
translation_of: Archive/B2G_OS/Developing_Gaia/Market_customizations_guide
---
<div class="summary">
<p><span class="seoSummary">Customizações comerciais de imagem permitem especificar instruções de customização em tempo de compilação (por exemplo, quais aplicativos devem pertencer à imagem) em diretórios separados, sem modificar o repositório principal do Gaia. Você pode incluir suas próprias customizações em diretórios distintos ou usar diretórios pré-existentes que vêm com o fonte. Essas customizações são especificadas com as opções de compilação. Nesse artigo veremos em detalhe como criar e usar essas customizações.</span></p>
</div>

<h2 id="Visão_geral">Visão geral</h2>

<p>Desde a versão 1.0.1, o Firefox OS usa o mesmo mecanismo que o Firefox para customizações. Todos os recursos mencionados nesse artigo funcionam no Firefox 1.0.2, salvo indicação em contrário.<br>
 <br>
 Nós criamos um <a href="https://github.com/mozilla-b2g/gaia/tree/master/customization">exemplo completo de customização do Gaia</a> como parte do repositório Gaia. Estude isso para aprender em primeira-mão o que pode ser feito com a customização em tempo de compilação. Isso também pode ser referenciado no artigo abaixo. Se você precisa criar sua própria imagem de produção, você deve criar um outro repositório, copiar o modelo de customização dentro dele e fazer suas próprias alterações. Compile sua distribuição de produção com o comando:</p>

<p><code>make production GAIA_DISTRIBUTION_DIR=./<em>your-customization-directory-name</em></code>.</p>

<div class="note">
<p><strong>Nota</strong>: Envie um "pull request" para o repo do Github acima se você tem alguma sugestão para melhorar o exemplo, ou se vir algo que foi alterado nesse artigo mas não atualizado no código.</p>
</div>

<p>Abaixo a estrutura do exemplo de customização:</p>

<pre>  customize-sample
  ├── power
  │   ├── carrier_power_on.png
  │   └── carrier_power_off.png
  ├── ringtones
  │   ├── list.json
  │   └── ringer_dream_theme.ogg
  ├── wallpapers
  │   ├── customize.png
  │   └── list.json
  ├── browser.json
  ├── calendar.json
  ├── contacts.json
  ├── costcontrol.json
  ├── homescreens.json
  ├── network.json
  ├── sensors.json
  ├── settings.json
  ├── sms-blacklist.json
  ├── support.json
  ├── wapuaprof.json
  └── apps.list</pre>

<div class="note">
<p><strong>Nota</strong>: Todos os arquivos são opcionais. Se você não fornecer o arquivo, será retornado aos padrões.</p>
</div>

<p>Nós discutiremos todas as customizações opcionais nas seções seguintes, mas primeiramente vamos ver como aplicar uma customização no Gaia.</p>

<h2 id="Etapas_para_aplicar_uma_customização">Etapas para aplicar uma customização</h2>

<p>Para aplicar o exemplo de customização no Gaia:</p>

<ol>
 <li>Clone o código fonte do Gaia do <a href="https://github.com/mozilla-b2g/gaia">https://github.com/mozilla-b2g/gaia</a>.</li>
 <li>Você pode copiar o diretório <code>gaia/customization/</code> para um novo diretório ou fazer sua customização diretamente no diretório <code>gaia/customization/</code>. O caminho para esse diretório é referenciado nesse artigo como <code>&lt;DISTRIBUTION_PATH&gt;</code>, obviamente altere isso para o caminho do seu diretório.</li>
 <li>Conecte o dispositivo Firefox OS ao seu computador via USB e verifique se ele é reconhecido pelo ADB.</li>
 <li>Compile o Gaia, especificando o local da customização com a variável de ambiente <code>GAIA_DISTRIBUTION_DIR</code> como por exemplo:
  <pre class="brush: bash">GAIA_DISTRIBUTION_DIR=&lt;DISTRIBUTION_PATH&gt; make production</pre>
 </li>
 <li>Você deve agora ter o Gaia compilado no seu dispositivo Firefox OS com as customizações aplicadas.</li>
</ol>

<p>Se você copiar o diretório de customização para <code>gaia/distribution/</code>, basta executar o comando <code>make</code> sem especificar a variável de ambiente:</p>

<pre class="brush: bash">make production</pre>

<div class="note">
<p><strong>Nota</strong>: Algumas customizações são feitas pelos scripts de compilação do Gaia. Verifique o artigo <a href="https://developer.mozilla.org/pt-BR/Firefox_OS/Developing_Gaia/make_options_reference">opções do Make</a> para saber sobre customizações de scripts de compilação.</p>
</div>

<div class="note">
<p><strong>Nota</strong>: Customizações específicas de SIM card são incluídas em tempo de compilação, mas aplicadas em tempo de execução durante o procedimento de Primeira utilização.</p>
</div>

<h2 id="Customizações_em_tempo_de_compilação">Customizações em tempo de compilação</h2>

<p>Veremos agora as diferentes opções disponíveis no modelo.</p>

<h3 id="power">power/</h3>

<p>Customiza as animações (ou imagens estáticas) durante o procedimento de ligar e desligar o dispositivo. Os arquivos podem ser animações MP4 ou imagens estáticas PNG.</p>

<p>Nomes de arquivos válidos são:</p>

<ul>
 <li><code>carrier_power_on.png</code></li>
 <li><code>carrier_power_on.mp4</code></li>
 <li><code>carrier_power_off.png</code></li>
 <li><code>carrier_power_off.mp4</code></li>
</ul>

<h3 id="ringtones">ringtones/</h3>

<p>Toques customizados são incluídos aqui. <code>list.json</code> devem conter os nomes de arquivos dos toques, como isso:</p>

<pre class="brush: js">  {
    "ringer_classic_courier.opus": "",
    "ringer_dream_theme.ogg": "",
    "ringer_loud_windchimes.opus": "",
    "ringer_bitbounce.opus": ""
  }</pre>

<p>Toques customizados são selecionados no aplicativo de configuração em <em>Sound &gt; Ringer</em>. O toque padrão deve ser configurado em <code>settings.json</code>, usando DataURI, você pode usar o comando <strong>datauri</strong> disponível em node/npm, instale-o digitando <code>npm install datauri -g</code> e converta o arquivo para DataURI: <code>datauri &lt;FILE&gt;</code></p>

<h3 id="wallpapers">wallpapers/</h3>

<p>Papeis de parede customizados (arquivos PNG) devem ser incluídos aqui e listados em <code>list.json</code>, que podem ser selecionados no aplicativo de configuração em<em> Display &gt; Wallpaper</em>.</p>

<p>O papel de parede padrão deve ser selecionado em <code>settings.json</code>, usando a seguinte linha:</p>

<pre class="brush: js">"wallpaper.image": "image location"</pre>

<div class="note">
<p><strong>Nota</strong>: A imagem pode ser especificada como um caminho de arquivo, ou codificado em Base 64 URI.</p>
</div>

<h3 id="browser.json">browser.json</h3>

<p>Esse arquivo permite adicionar customizações no aplicativo Browser, como favoritos e motor de busca padrão. Veja a seção <a href="#Browser_bookmarks">Favoritos do navegador e motor de busca</a> para mais detalhes de como fazer.</p>

<h3 id="calendar.json">calendar.json</h3>

<p>Esse arquivo permite usar seu próprio calendário customizado no aplicativo Calendário do Firefox OS. Você precisará especificar suas credenciais Google Oauth credentials. Adicionalmente, é necessário o acesso à API CalDav: para gerar a chave requerida pela API, você precisa ir na página do Google <a href="https://developers.google.com/google-apps/calendar/caldav/v2/guide#creating_your_client_id">criando sua ID de cliente</a> e seguir as seguintes instruções:</p>

<ol>
 <li>Abra o <a href="https://code.google.com/apis/console/b/0">console API</a>.</li>
 <li>Crie um projeto e habilite <em>Calendar CalDav API</em> em <em>APIs &amp; auth &gt; APIs</em>.</li>
 <li>Clique em <em>Credentials</em>.</li>
 <li>Clique em <em>Create new client ID</em></li>
 <li>Selecione <em>Installed application </em>na opção <em>Application type</em> e <em>Other</em> na opção <em>Installed application type</em>, enão pressione <em>Create Client ID</em>. Será fornecido um <em>Client ID</em> e <em>Client secret</em>.</li>
 <li>Abra o arquivo <code>calendar.json</code>, altere o <code>client_id</code> e <code>client_secret</code> com <em>Client ID</em> e <em>Client secret</em> fornecidos no console do Google API console</li>
 <li>Salve e feche o arquivo.</li>
</ol>

<div class="note">
<p><strong>Nota</strong>: O uso da API é limitado a 1,000,000 de requisições por dia</p>
</div>

<h3 id="camera.json_(Tamanhos_das_imagens_nos_aplicativos_Camera_e_Galeria)">camera.json (Tamanhos das imagens nos aplicativos Camera e Galeria)</h3>

<div class="code-body highlight">
<pre class="line"><span class="p">{</span>
  <span class="nt">"maxImagePixelSize"</span><span class="p">:</span> <span class="mi">6000000</span><span class="p">,</span>
  <span class="nt">"maxSnapshotPixelSize"</span><span class="p">:</span> <span class="mi">4000000</span><span class="p">,</span>
  <span class="nt">"requiredEXIFPreviewSize"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"width"</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
    <span class="nt">"height"</span><span class="p">:</span> <span class="mi">1222</span>
  <span class="p">}</span>
<span class="p">}</span></pre>
</div>

<p><code>maxImagePixelSize</code> e <code>maxSnapshotPixelSize</code> são os tamanhos máximos em pixels permitidos para visualização de uma imagem na Galeria e na Camera. O padrão é 5 mega-pixels (5*2<sup>20</sup> pixels; 5mp).</p>

<p>Opcionalmentem, você pode definir variáveis para especificar o tamanho mínimo da visualização EXIF (<u><strong>Ex</strong></u>changeable <u><strong>I</strong></u>mage <u><strong>F</strong></u>ile) que será apresentada na visualização de tela cheia incluindo a propriedade<code> requiredEXIFPreviewSize</code>. Se você não especificar essa propriedade a visualização EXIF somente será utilizada se for grande o suficiente para preencher a tela na largura e altura nas duas orientações (retrato ou paisagem).</p>

<h3 id="contacts.json">contacts.json</h3>

<p>Os contatos listados nesse arquivo serão incluídos no banco de dados do aplicativo Contatos assim que o Gaia for compilado.</p>

<p>A seguir um exemplo do arquivo <code>contacts.json</code>:</p>

<pre class="brush: js">[
   {
     "name": ["John Doe"],
     "givenName": ["John"],
     "familyName": ["Doe"],
     "nickname": ["Johnny"],
     "category": ["Work", "Racing Team"],
     "email": [
       {
         "type": ["personal"],
         "value": "john.doe@example.org",
         "pref": true
       },
       {
         "type": ["work"],
         "value": "jdoe@example.com"
       }
     ],
     "adr": [
       {
         "type": ["personal"],
         "streetAddress": "123 Foopy St.",
         "locality": "San Francisco",
         "region": "Downtown",
         "postalCode": "94030",
         "countryName": "US"
       }
     ]
   },
   {
     "name": ["CarrierX"],
     "email": [
       {
         "type": ["work"],
         "value": "support@carrierx.com"
       }
     ],
     "url": [
       {
         "type": ["work"],
         "value": "https://www.carrierx.com"
       }
     ]
   }
 ]</pre>

<div class="note">
<p><strong>Nota</strong>: Veja a <a href="https://developer.mozilla.org/pt-BR/docs/WebAPI/Contacts">página da API Contacts</a> para detalhes do layout dos objetos.</p>
</div>

<div class="note">
<p><strong>Nota</strong>: Para customizações dependentes do SIM-Card, veja a seção <a href="#Browser_bookmarks">Favoritos do navegador e motor de busca</a>.</p>
</div>

<h3 id="homescreens.json">homescreens.json</h3>

<p><a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/homescreens.json">homescreens.json</a> define os aplicativos que ficam na dock e página inicial do Firefox OS e em que ordem. Por padrão o arquivo parece com:</p>

<pre class="brush: js">{"homescreens": [
   [
     ["apps", "communications", "dialer"],
     ["apps", "sms"],
     ["apps", "browser"],
     ["apps", "camera"]
   ]
 ]}</pre>

<p>No exemplo aparecem quatro aplicativos na dock. Se for incluído outro array, o conjunto de aplicativos aparecem na página 1 da tela inicial, o próximo conjunto na página 2 e assim por diante.</p>

<pre class="brush: js">{"homescreens": [
   [ // We're in the dock!
     ["apps", "communications", "dialer"],
     ["apps", "sms"],
     ["apps", "browser"],
     ["apps", "camera"]
   ],
   [ // We're on Page 1 of the homescreen
     ["apps", "email"],
     ["apps", "settings"],
     ["apps", "clock"],
     ["apps", "calendar"]
   ],
   [ // We're on Page 2 of the homescreen
     ["external-apps", "customapp1"],
     ["external-apps", "customapp2"],
     ["external-apps", "customapp3"],
     ["external-apps", "customapp4"]
   ]
 ]}</pre>

<p>O primeiro item de cada sub-array é a pasta dentro da qual o aplicativo aparece, o segundo item é o nome do diretório do aplicativo.</p>

<h4 id="Collections">Collections</h4>

<div class="note">
<p><strong>Nota</strong>: No Firefox 2.0, o diretório <code>collections</code> foi movido para dentro do aplicativo <code>homescreen</code> para ficar dentro do seu próprio aplicativo <code>collections</code>. Observer também que alguns campos do manifesto mudaram (veja <a href="https://github.com/mozilla-b2g/gaia/blob/master/apps/collection/collections/funny/manifest.collection">funny collection manifest</a> para um exemplo): <code>provider_id</code> foi alterado para <code>categoryId</code>, e <code>apps</code> foi alterado para <code>pinned</code>.</p>
</div>

<p>Collections (coleção) são grupos de aplicativos que têm seus próprios ícones que aparecem na tela inicial. Quando o ícone é tocado, uma nova tela aparece contendo os ícones dos aplicativos da coleção. Veja  <a href="https://github.com/mozilla-b2g/gaia/tree/master/apps/homescreen/collections">diretório collections no código fonte</a> para ver quais coleções estão disponíveis por padrão:</p>

<ul>
 <li><code>funny</code>: Aproveite os últimos aplicativos de diversão.</li>
 <li><code>games</code>: Jogos online.</li>
 <li><code>local</code>: O que está acontecendo a sua volta?</li>
 <li><code>music</code>: Escute suas músicas favoritas.</li>
 <li><code>news</code>: Mantenha-se atualizado com as fontes mundiais de notícias.</li>
 <li><code>shopping</code>: Seguindo as tendências das compras.</li>
 <li><code>showbiz</code>: Encontre aplicativos para entretenimento.</li>
 <li><code>social</code>: Siga sua rede social em qualquer lugar.</li>
 <li><code>sports</code>: Os melhores aplicativos sobre esportes.</li>
 <li><code>tv</code>: Aplicativos relacionados à TV.</li>
</ul>

<p>Em cada um desses diretórios você encontrará arquivos de ícones com resoluções diferentes, mais um arquivo de manifesto que define o metadado sobre a coleção como nome, papel e caminhos para os ícones.</p>

<p>No arquivo <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/homescreens.json"><code>homescreens.json</code></a> é possível definir quais coleções devem ser carregadas, quais páginas devem aparecer e em qual ordem. Por exemplo, se nós quisermos especificar que apareçam as coleções <code>shopping</code>, <code>social</code>, <code>sports</code> e <code>tv</code>, devemos escrever:</p>

<pre class="brush: js">{"homescreens": [
   [
     ["apps/homescreen/collections", "social"],
     ["apps/homescreen/collections", "games"],
     ["apps/homescreen/collections", "music"],
     ["apps/homescreen/collections", "showbiz"]
   ], [
     ["apps", "communications", "dialer"],
     ["apps", "sms"],
     ["apps", "browser"],
     ["apps", "camera"]
   ]
 ]}</pre>

<p>Cada posição no nível mais alto do arry refe-se à página da tela inicial. Aqui, as coleções devem aparecer na dock, e os aplicativos individuais aparecerão na página um da tela inicial.</p>

<div class="note">
<p><strong>Nota</strong>: Por padrão, quatro coleções são pré-preenchidas na primeira página da tela inicial do Gaia: <em>Social</em>, <em>Games</em>, <em>Music</em>, and <em>Entertainment</em>.</p>
</div>

<div class="note">
<p><strong>Nota</strong>: Nomes de coleção são escritos em minúsculas.</p>
</div>

<h5 id="O_que_contém_nas_coleções">O que contém nas coleções</h5>

<p>Coleções são compostas por dois tipos de aplicativos.<br>
 <br>
 <strong>Aplicativos locais</strong> são definidos em tempo de compilação por meio de arquivos de manifesto, armazenados em <code>/apps/homescreen/collections/&lt;collectionName&gt;/manifest.collection</code>. Os aplicativos locais contidos em cada coleção são definidos no arquivo manifesto. Por exemplo, o manifesto da coleção social (contém os aplicativos discador, sms, contatos e email)  The local apps contained within each collection are defined in the mainfest file. For example, the social collection (contains dialer, sms, contacts and email apps) parece com:</p>

<pre class="brush: js">{
  "name": "Social",
  "role": "collection",
  "provider_id": "289", // adaptive search identifier
  "apps": [
    ["apps", "communications", "dialer"],
    ["apps", "sms"],
    ["apps", "communications", "contacts"],
    ["apps", "email"]
  ],
  "default_locale": "en-US",
  "icons": {
    "60": "/collections/social/icon.png",
    "90": "/collections/social/icon@1.5x.png",
    "120": "/collections/social/icon@2x.png"
  }
 }</pre>

<p><strong>Aplicativos remotos são </strong>fornecidos pela busca adaptativa em tempo de execução quando o dispositivo está online.</p>

<h5 id="Como_traduzir_coleções">Como traduzir coleções</h5>

<p>Traduções de coleções devem ser definidas nos arquivos de localização no aplicativo tela inicial, no diretório <code>apps/homescreen/locales/</code>. Cada arquivo de localização tem a seguinte estrutura de nome <code>collections.&lt;langCode&gt;.properties</code> — onde <code>&lt;langCode&gt;</code> é por exemplo <code>fr</code> para francês — e contém linhas simples contendo a string em inglês e sua versão traduzida. Um exemplo de arquivo de localização em francês:</p>

<pre><span class="c1"># Add bookmark to homescreen</span><span class="na">
add-to-home-screen</span><span class="o">=</span><span class="s">Ajouter à l’écran d’accueil</span><span class="na">
add-to-home-screen-header</span><span class="o">=</span><span class="s">Ajouter un lien</span><span class="na">
website-name</span><span class="o">=</span><span class="s">Nom du site web</span><span class="na">
address</span><span class="o">=</span><span class="s">Adresse</span><span class="na">
added-to-home-screen</span><span class="o">=</span><span class="s">Ajouté à l’écran d’accueil</span></pre>

<h5 id="Coleções_customizadas">Coleções customizadas</h5>

<p>Assim como no Firefox OS 1.3, você pode definir suas próprias coleções. Simplesmente crie-as no <a href="https://github.com/mozilla-b2g/gaia/tree/master/apps/homescreen/collections">diretório <code>collections</code></a>, e faça a referência ao diretório no arquivo <code>collections.json</code>, como mostrado acima.</p>

<h4 id="Propriedades_da_tela_inicial_vertical">Propriedades da tela inicial vertical</h4>

<p>A partir do Firefox 2.0, você pode escolher mostrar a tela inicial vertical ao invés do padrão na horizontal. As propriedades da tela inicial vertical são definidas em <a href="https://github.com/mozilla-b2g/gaia/blob/master/apps/verticalhome/build/default-homescreens.json">default-homescreens.json</a>, incluindo quais aplicativos e coleções devem aparecer, quantas colunas a tela inicial deve ter e quais favoritos devem aparecer.</p>

<h3 id="network.json_(não_na_pasta_de_customização)">network.json (não na pasta de customização)</h3>

<div class="warning">
<p><strong>Importante</strong>: Isso não é mais suportado no Firefox OS 1.4.</p>
</div>

<p>Nas versões anteriores à Firefox OS esse arquivo pode ser criado em <code>gaia/apps/settings/resources</code>, e possibilita configurar os tipos de rede suportadas pelo dispositivo. Firefox OS suporta os seguintes tipos:</p>

<ul>
 <li>'wcdma/gsm' (preferência WCDMA)</li>
 <li>'gsm'</li>
 <li>'wcdma'</li>
 <li>'wcdma/gsm-auto' (preferência GSM)</li>
 <li>'cdma/evdo' (preferência CDMA)</li>
 <li>'cdma'</li>
 <li>'evdo'</li>
 <li>'wcdma/gsm/cdma/evdo' (Automático)</li>
</ul>

<p>A seguir um exemplo:</p>

<pre class="brush: js">{
  "types":  [
    "cdma/evdo",
    "cdma", "evdo"
  ]
}</pre>

<h3 id="sensors.json">sensors.json</h3>

<p>Define as capacidade do dispositivo com sensores. Por padrão contém:</p>

<pre class="brush: js">{ "ambientLight": true }</pre>

<p>Você pode configurar o valor para <code>false</code> caso deseje desabilitar o sensor.</p>

<h3 id="settings.json">settings.json</h3>

<ul>
 <li>Configurações gerais: 1.0.1</li>
 <li>Provedor de busca do padrão do Rocketbar: 2.0</li>
</ul>

<p>Esse arquivo possibilita configurar os valores padrões da configuração como papel de parede, bloqueio de tela habilitado/desabilitado, bluetooth ligado/desligado, etc. Você pode consultar <a href="https://github.com/mozilla-b2g/gaia/blob/master/build/config/common-settings.json">build/config/common-settings.json</a> para verificar o que pode ser configurado em <code>settings.json</code>, por exemplo, você pode configurar <code><span class="nt">"wifi.enabled"</span><span class="p">:</span> <span class="kc">false</span></code> para desabilitar o WiFi por padrão.</p>

<p>Você coloca suas configurações customizadas em <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/settings.json">customization/settings.json</a> e então pode compilar usando <code>make production GAIA_DISTRIBUTION_DIR=customization</code> (ou outro diretório que você decida para fazer seu próprio prefil customizado).</p>

<p>No Firefox OS 2.0 e superiores, você pode definir as seguintes configurações adicionais no arquivo <code>settings.json</code>:</p>

<pre class="language-html">"search.urlTemplate": "https://www.google.com/search?q={searchTerms}",
"search.suggestionsUrlTemplate": "https://www.google.com/complete/search?client=firefox&amp;q={searchTerms}",
"search.iconUrl": "data:image/x-icon;base64,AAABAAIAEBAAAAAAAAB9AQAAJ [TRUNCATED FOR BREVITY]
</pre>

<h3 id="Customização_do_provedor_de_busca">Customização do provedor de busca</h3>

<p>No Firefox 2.0+, existe uma lista padrão de provedores de busca e seus arquivos de ícones em <a href="https://developer.mozilla.org/en-US/docs/https://github.com/mozilla-b2g/gaia/blob/master/apps/settings/resources/search/providers.json">apps/settings/resources/search/providers.json</a>. Você pode configurar isso em tempo de compilação modificando <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/search/providers.json">customization/search/providers.json</a> e adicionando os arquivos de ícones apropriados no mesmo diretório. O conteúdo desse diretório irá sobrescrerver o diretório <code>app/settings/resources/search</code> se for encontrado no momento da compilação e se você copiar com o comando:</p>

<p><code>make production GAIA_DISTRIBUTION_DIR=customization</code>.</p>

<h3 id="Customizar_o_aplicativo_Homescreen_padrão">Customizar o aplicativo Homescreen padrão</h3>

<p>homescreen.appName possibilita especificar o aplicativo de tela de início padrão.</p>

<div class="code-body highlight">
<pre class="line"><span class="p">{</span> <span class="nt">"homescreen.appName"</span><span class="p">:</span> <span class="s2">"homescreen-stingray"</span> <span class="p">}</span></pre>
</div>

<h3 id="sms-blacklist.json">sms-blacklist.json</h3>

<p>Esse arquivo contem uma lista negra customizada de SMS: não é possível enviar SMS para os números especificados nessa lista. Ela sobrescreve a lista descrita no arquivo <code>blacklist.json</code> que fica no aplicativo SMS. Os números devem ser descritos em um array como o exemplo abaixo:</p>

<pre>["11223344", "55667788"]</pre>

<h3 id="cellbroadcast">cellbroadcast</h3>

<p>Canais de escuta:</p>

<ul>
 <li>availability: runtime: Settings — <code>ril.cellbroadcast.searchlist</code></li>
 <li>type: string</li>
 <li>valid format: <code>\d(-\d)?(,\d(-\d))*</code></li>
</ul>

<p>Desabilitar reporte de eventos:</p>

<ul>
 <li>availability:
  <ul>
   <li>run time: Settings — <code>ril.cellbroadcast.disabled</code></li>
   <li>build time: Preference — <code>ril.cellbroadcast.disabled</code></li>
  </ul>
 </li>
 <li>type: boolean</li>
 <li>meaning: true to completely shutdown Cell Broadcast reporting.</li>
</ul>

<div class="note">
<p><strong>Nota</strong>: Configurações padrão disponíveis em <a href="https://mxr.mozilla.org/gaia/source/shared/resources/apn/operator_variant.xml">operator_variant.xml</a>.</p>
</div>

<h3 id="support.json">support.json</h3>

<p>Esse arquivo contém contatos de suporte incluindo suporte online e suporte telefônico. Quando incluído, esse arquivo sobrescreve o arquivo <code>support.json</code> no aplicativo Settings. Uma vez que a customização irá sobrescrever as configurações padrão, se você quiser manter as configurações padrão e adicionar alguns recursos extras, você deve copiar essas configurações dos aplicativos do dispositivo e adiconar suas próprias customizações neles.</p>

<p>Abaixo um exemplo de como o JSON deve parecer:</p>

<pre class="brush: js">{
   "onlinesupport": {
     "href": "http://support.mozilla.org/",
     "title": "Mozilla Support"
   },
   "callsupport": [
     {
       "href": "tel:12345678",
       "title": "Call Support 1"
     },
     {
       "href": "tel:87654321",
       "title": "Call Support 2"
     }
   ]
 }</pre>

<h3 id="perfil_user_agent_WAP_(wapuaprof.json)">perfil user agent WAP (wapuaprof.json)</h3>

<p>O perfil user agent WAP sobrescreve as informações do user agent quando envia pacotes WAP.</p>

<h3 id="apps.list">apps.list</h3>

<p>Isso permite que você especifique quais aplicativos você deseja carregar em tempo de execução (similar ao <code>variant.json</code>, como explicado na seção <a href="#Applications">Aplicativos</a> abaixo.</p>

<pre class="brush: bash">apps/*
external-apps/*
outoftree_apps/*</pre>

<p>Você pode especificar aplicativos individuais ao invés de todo o diretório:</p>

<pre class="brush: bash">apps/email
apps/settings</pre>

<div class="note">
<p><strong>Nota</strong>: Se você quiser incluir aplicativos externos como parte da sua imagem do Gaia, você precisa compilá-los numa forma específica e colocá-los no diretório <code>gaia/external-apps/</code>. Leia <a href="#Building_Prebundled_web_apps">Compilando aplicativos pré-empacotados</a> para saber como.</p>
</div>

<div class="warning">
<p><strong>Important</strong>e: Aplicativos que você incluir como parte de uma imagem customizada precisa ser incluída no acordo com a Mozilla's Distribution Agreement.</p>
</div>

<h2 id="Outras_opções_de_customização">Outras opções de customização</h2>

<p>Existem muitas outras customizações que podem ser feitas. Vamos vê-las agora.</p>

<div class="note">
<p><strong>Nota</strong>: O script de compilação utilizado em muitas das seções abaixo pode ser encontrado em <a href="https://github.com/mozilla-b2g/gaia/blob/master/build/applications-data.js">gaia/build/applications-data.js</a>. O scrtip é copiado num arquivo <code>init.json</code> no aplicativo browser em tempo de compilação.</p>
</div>

<h3 id="Favoritos_do_navegador_e_motor_de_busca_padrão"><a name="Browser_bookmarks"></a>Favoritos do navegador e motor de busca padrão</h3>

<p>Favoritos: 1.0.1</p>

<p>Motor de busca padrão: 1.2</p>

<p>Motor de busca padrão para Rocketbar em providers.json: 2.0</p>

<p>Podem ser customizados em tempo de compilação com diferentes variantes por cada país e rede em uma compilação. Os dados customizados são inseridos no aplicativo do navegador na primeira vez que é executado, baseado nos códigos <a href="http://en.wikipedia.org/wiki/Mobile_country_code">MCC e MNC</a> do SIM Card presente no dispositivo.</p>

<div class="note">
<p><strong>Nota</strong>: Favoritos podem ser customizados nas versões do Firefox OS 1.0.1 e superiores. Motor de busca padrão nas versões Firefox OS 1.2 e superiores.</p>
</div>

<p>O exemplo abaixo (<code>browser.json</code>) mostra uma configuração para a operadora Vivo no Brasil (724006, onde 724 é o código do Brasil e 006 código da Vivo de acordo com a codificação MCC e MNC), com um fallback padrão (000000) no caso de não coincidir o SIM card ou o mesmo não estiver presente.</p>

<pre class="brush: js">content = {
   '000000': {
     'bookmarks': [
       { 'title': 'Mozilla',
         'uri': 'http://mozilla.org',
         'iconUri':
           'data:image/png;base64,AAABAAIAEBAAAAEAIABo[truncated]'
       },
       { 'title': 'Firefox OS',
         'uri': 'http://mozilla.org/firefoxos',
         'iconUri':
           'data:image/png;base64,AAABAAIAEBAAAAEA[truncated]'
       }
     ],
     'searchEngines' : [
        {
          'title': 'Google',
          'uri': 'http://www.google.com/search?q={searchTerms}',
          'iconUri':
            'data:image/png;base64,AAABAAIAEBAAAAEAIABoBAA[truncated]'
        }
      ],
      'settings' : {
        'defaultSearchEngine': 'http://www.google.com/search?q={searchTerms}'
      }
   },

   '724006': {
     "bookmarks": [
       { "title": "Vivo Busca",
         "uri": "http://www.google.com.br/m/search",
         "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC[truncated]"
       },
       { "title": "Serviços e Downloads",
         "uri": "http://vds.vivo.com.br",
         "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACA[truncated]"
       },
       {
         "title": "Site Vivo",
         "uri": "http://www.vivo.com.br/conteudosmartphone",
         "iconUri": "data:image/jpg;base64,/9j/4AAQSkZJRg[truncated]"
       }
     ],
     'searchEngines' : [
        {
          'title': 'Yahoo',
          'uri': 'http://search.yahoo.com/search?q={searchTerms}',
          'iconUri':
            'data:image/png;base64,AAABAAIAEBAAAAEAIABoBAA[truncated]'
        }
      ],
      'settings' : {
        'defaultSearchEngine': 'http://search.yahoo.com/search?q={searchTerms}'
      }
   }
 };</pre>

<p>No exemplo, se um SIM Card da Vivo estiver presente na primeira vez que for executado, o usuário verá os favoritos da Vivo e o Yahoo como o motor de busca. Se estiver um outro SIM Card ou nenhum, você verá os favoritos da Mozilla e o Google como motor de busca padrão. Existem algumas partes importantes a serem observadas:</p>

<ul>
 <li>A propriedade <code>defaultSearchEngine</code> <em>deve</em> conicidir com a propriedade <code>uri</code> do motor de busca especificado. Essa string atua como um modelo para <code>{searchTerms}</code> placeholder, o qual será substituíro com a pesquisa do usuário em tempo de execução. Outros valores como strings de busca devem ser adicionadas à pesquisa do usuarío no template da URL.</li>
 <li>O favicon das URLs mostrados são dados da URLs codificados em base64 dos dados da imagem (truncados para abreviar) ao invés de URLs de HTTP. Isto é recomendado para que os ícones apareçam na primeira vez que o navegador é executado, mesmo se o usuário não esteja conectado à Internet.</li>
 <li>Observe que diversas customizações podem ser aplicadas para diferentes países e diferentes redes numa mesma imagem, com diferentes códigos de 6 dígitos representando cada variante. O código de 6 dígitos é construído com o código MCC mais o código MNC, completados com zeros à direita para garantir que tenham o tamanho de 3 dígitos cada.</li>
 <li>Quanto popular os dados padrão o navegador primeiro verificará a exata coincidência com os códigos MCC e MNC, se não coincidir vai tentar MCC+000 e finalmente não havendo coincidência fará o <em>fallback</em> para 000+000.</li>
 <li>Ao atualizar entre versões do Gaia, novas customizações somente serão aplicadas se o tipo de customização é um novo recurso em uma nova versão do Gaia para a qual está se atualizando. Customizações anteriores não serão sobrescritas.</li>
</ul>

<div class="note">
<p><strong>Nota</strong>: O navegador mostrará os favoritos na ordem reversa, ou seja, o primeiro favorito no arquivo json será o último na lista do navegador e assim por diante.</p>
</div>

<h3 id="Customização_única_da_variante_para_sobrescrever_a_lista_de_provedores_e_o_provedor_de_busca_do_Rocketbar">Customização única da variante para sobrescrever a lista de provedores e o provedor de busca do Rocketbar</h3>

<ol>
 <li>O provedor de busca padrão do Rocketbar e a lista de provedores pode ser customizada por MCC/MNC — dados adicionados na primeira vez que um SIM card é inserido no telefone — especificando-o nos arquivos JSON em seu diretório de distribuição. Por exemplo:
  <ul>
   <li>A lista de provedores por MCC/MNC é especificada em <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/mobizilla/mobizilla_search.json">mobizilla_search.json</a> no nosso exemplo de customização.</li>
   <li>O provedor padrão do Rocketbar é especificado em <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/mobizilla/mobizilla_default_search.json">mobizilla_default_search.json</a> no nosso exemplo de customização.</li>
  </ul>
 </li>
 <li><a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/variant.json">variant.json</a> então define qual arquivo <code>.json</code> é utilizado para especificar as configurações para cada par MCC/MNC pair; veja <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/variant.json#L47-L48">as linhas 47–48</a> no nosso exemplo:
  <pre class="brush: json  language-json"><code class="language-json"><span class="key token">"search":</span> <span class="string token">"mobizilla/mobizilla_search.json"</span><span class="punctuation token">,</span>
<span class="key token">"default_search":</span> <span class="string token">"mobizilla/mobizilla_default_search.json"</span><span class="punctuation token">,</span></code></pre>
 </li>
 <li><code>variant.json</code> é colocado no diretório raiz da nossa distribuição.</li>
 <li>Para aplicar a configuração da variante única você deve definir a variável <code>GAIA_DISTRIBUTION_DIR</code> como o caminho para o diretório da sua distribuição quando compilar o Gaia.</li>
</ol>

<h3 id="Configurações_de_dados_e_mensagens">Configurações de dados e mensagens</h3>

<p>As configurações são customizadas em tempo de execução.</p>

<p>Para aplicar configurações específicas, altere<code> gaia/shared/resources/apn/apns_conf_local.xml</code>, simplesmente adicionando ou editando os blocos:</p>

<pre class="brush: xml"> &lt;apn carrier="Test Network"
      mcc="001"
      mnc="01"
      apn="internet"
      user="user"
      password="password"
      proxy="127.0.0.1"
      port="8080"
      mmsc="http://127.0.0.1"
      mmsproxy="127.0.0.1"
      mmsport="8080"
      authtype="0"
      type="default,supl,mms"
  /&gt;</pre>

<h3 id="Configurações_de_correio_de_voz_e_broadcasting">Configurações de correio de voz e broadcasting</h3>

<p>Para aplicar as configurações, altere <code>gaia/shared/resources/apn/operator_variant.xml</code>. Incluindo ou editando os atributos conforme necessário:</p>

<pre class="brush: xml">   &lt;operator carrier="Test Network with Operator Variant Settings"
       mcc="001"
       mnc="01"
       cellBroadcastSearchList="0,1,2,3"
       voicemail="999999"
   /&gt;</pre>

<h3 id="Perfil_user_agent_WAP">Perfil user agent WAP</h3>

<p>O perfil user agent WAP é outra aplicação que permite customização em tempo de execução. Ele sobrescreve as informação do user agent quando envia pacotes WAP, baseado no MCC/MNC O perfil que sobrescreve possui as partes <code>url</code> e <code>tagname</code>, mas nós somente suportamos <code>url</code> em nossa implementação atual.</p>

<p>O user agent WAP usa o mesmo estilo de codificação que o navegador, embora "000000" é usado como perfil padrão. Um exemplo a seguir:</p>

<pre class="brush: js">   {
     "000000": {
       "url": "http://example.url/default.xml"
     },
     "123001": {
       "url": "http://example.url/custom123001.xml"
     }
   }</pre>

<p>Nesse exemplo, a <code>url</code> do perfil padrão é <code>http://example.url/default.xml</code>, para mcc = 123 e mnc = 001, a <code>url</code> é<code> http://example.url/custom123001.xml</code>. Se existir outro ic card com mcc = 123 e mnc=100, a seria <code>http://example.url/default.xml</code>.</p>

<p>Se o 000000 for removido desse exemplo:</p>

<pre class="brush: js">  {
     "123001": {
       "url": "http://example.url/custom123001.xml"
     }
   }</pre>

<p>A <code>url</code> do perfil UA do ic card com mcc = 123, mnc = 001 é agora sobrescrito por <code>http://example.url/custom123001.xml</code>. Nenhum outro será sobrescrito.</p>

<p>Se nós tivermos o "000000" como antes, mas também "123001" com nenhuma <code>url</code> dentro:</p>

<pre class="brush: js">   {
     "000000": {
       "url": "http://example.url/default.xml"
     },
     "123001": {}
   }</pre>

<p>Todos os perfis UA agora são sobrescritos por <code>http://example.url/default.xml</code></p>

<h3 id="Aplicativos"><a name="Applications"></a>Aplicativos</h3>

<p>As aplicações instaladas no Firefox OS podem ser customizadas em tempo de execução de diversas formas (veja também <a href="https://developer.mozilla.org/pt-BR/Firefox_OS/Desenvolvendo_Gaia/Alterando_aplicativos_empacotados_compilacao_imagem">esse artigo</a>). Porém a melhor forma é editando o arquivo de configuração <code>variant.json</code> que permite os aplicativos serem seletivamente instalados e colocados na posição desejada na tela inicial, dependendo da codificação MCC/MNC. As aplicações customizadas podem ser incluídas à lista de aplicações padrão.</p>

<p>A parte relevante do arquivo <code>variant.json</code> tipicamente parece com:</p>

<pre class="brush: js">   {
     "apps": {
       "puzzle":
         {
           "manifestURL": "https://owd.tid.es/store/packages/fe8e4a866c518a42db9d2041568684c1.webapp"
         },
       "store":
         {
           "manifestURL": "https://owd.tid.es/store/manifest.webapp",
           "installOrigin": "https://www.openwebdevice.com"
         }
     },
     "operators": [
       {
         "id": "movistar-co",
         "mcc-mnc": [
           "214-01",
           "214-02"
         ],
         "apps": [
           {
             "id": "store",
             "screen": 0,
             "location": 2
           }
         ]
       },
       {
         "id": "movistar-mx",
         "mcc-mnc": [
           "215-23"
         ],
         "apps": [
           {
             "id": "store",
             "screen": 0,
             "location": 2
           },
           {
             "id": "puzzle"
           }
         ]
       }
     ]
   }</pre>

<ul>
 <li>O primeiro objeto do JSON é chamado<code> apps</code>, e define os aplicativos a serem copiados durante a compilação. O exemplo usa dois aplicativos, um hospedado (store) e outro empacotado (puzzle). Observer que enquanto os aplicativos empacotados somente pecisam do <code>manifestURL</code>, os hospedados também precisam do <code>installOrigin</code> para que possam ser baixados.</li>
 <li>O segundo objeto, chamado <code>operators</code>, é responsável pela configuração baseada no MCC/MNC. O objeto contém um array de objetos para cada par MCC/MNC. Esses objetos definem o <code>id</code> da operadora, uma lista MCC/MNC para a configuração e uma lista de objetos <code>apps</code> definindo quais aplicativos serão instalados em cada caso.</li>
 <li>Cada objeto <code>apps</code> requer uma propriedade <code>id</code> e tem dois argumentos opcionais para configurar a posição na tela de inívio:
  <ul>
   <li>A propriedade <code>screen</code> indica o número da tela.</li>
   <li>A propriedade <code>location</code> indica a posição na tela.</li>
  </ul>
 </li>
</ul>

<h3 id="Contatos_de_suporte_contatos_padrão_papel_de_parede_e_toque_do_telefone">Contatos de suporte, contatos padrão, papel de parede e toque do telefone</h3>

<p>O mesmo arquivo <code>variant.json</code> — usado para configurar os aplicativos em tempo de execução dependendo do par MCC/MNC — também serve para configurar recursos específicos adicionando alguns atributos em cada operadora. Assim uma operadora pode ter as seguintes configurações:</p>

<pre class="brush: js">   { apps: ...
     "operators": [
       {
         "id": "movistar-co",
           "mcc-mnc": [
             "214-01",
             "214-02"
           ],
         "apps": [
           {
             "id": "store",
             "screen": 0,
             "location": 2
           }
         ],
         "support_contacts": "resources/support_contacts_movistar.json",
         "default_contacts": "resources/contacts_movistar.json",
         "ringtone": {
           "path": "resources/Movistar_Mid_ABR_128kbps.ogg",
           "name": "Tono Movistar"
         },
         "wallpaper": "resources/customize.jpg"
       },
       ...
   }</pre>

<p>Para cada operadora:</p>

<ol>
 <li><code>support_contacts</code> especifica o caminho para um arquivo contendo os contatos a serem exibidos na tela de ajuda (<code>Settings &gt; Help</code>), oferecendo a mesma funcionalidade que {{ anch ("support.json") }}. O formato do arquivo é:

  <pre class="brush: js">   {
     "onlinesupport": {
       "title": "Mozilla Support",
       "href": "http://test.mozilla.org/support"
     },
     "callsupport1": {
       "title": "Call Support (Primary)",
       "href": "tel:14155550001"
     },
     "callsupport2": {
       "title": "Call Support (Secondary)",
       "href": "tel:14155550002"
     }
   }</pre>
 </li>
 <li><code>default_contacts</code> contém o caminho para um arquivo que contém contatos que serão pré-carregados no aplicativo Contatos, dependendo do par MCC/MNC presente em tempo de execução. O nome das seções são os pares MCC/MNC, e o conteúdo da seção deve ser um array de contatos seguindo o mesmo formato que {{ anch("contacts.json") }}. Por examplo:
  <pre class="brush: js">    {
        "123123":
        [
            {name: ["John Doe"]},
            // etc
        ],
    }
</pre>
 </li>
 <li><code>ringtone</code> configura o toque padrão e contém dois atributos, ambos obrigatórios:
  <ul>
   <li>path: O caminho para o arquivo de audio.</li>
   <li>name: O nome a ser mostrado quando o toque for mostrado no aplicativo de configurações.</li>
  </ul>
 </li>
 <li><code>wallpaper</code> contém o caminho para o arquivo de imagem (PNG) que será configurado como o papel de parede padrão.</li>
</ol>

<h2 id="Compilando_aplicativos_pré-empacotados"><a name="Building_Prebundled_web_apps">Compilando aplicativos pré-empacotados</a></h2>

<p>Mais cedo, nós discutimos sobre o arquivo {{ anch("apps.list") }}, e agora ele pode ser usado para incluir aplicativos em sua imagem. Esses aplicativos precisam ser compilados de uma certa maneira, então adicionado no diretório <code>gaia/external-apps</code>.<br>
 <br>
 Para compilar aplicativos web pré-empacotados você pode utilizar o script <a href="https://github.com/yurenju/gaia-preload-app">gaia-preload-app</a>, que compila um webapp pré-empacotado a partir de uma URL <code>.webapp</code> URL. Ele pode aceitar manifestos de aplicativos hospedados, ou mini-manifestos de aplicativos empacotados.</p>

<h3 id="Para_empacotar_um_único_aplicativo_web">Para empacotar um único aplicativo web</h3>

<p>Informe a URL <code>.webapp</code> que você deseja empacotar e execute o seguinte comando:</p>

<pre>python preload.py http://&lt;webapp url&gt;</pre>

<p>Isso irá gerar um diretório com o mesmo nome do aplicativo, por exemplo <code>accuweather</code>.</p>

<h3 id="Processamento_batch_para_empacotar_vários_aplicativos_web">Processamento batch para empacotar vários aplicativos web</h3>

<p>Você pode criar um arquivo chamado <code>list</code>, contendo todos os nomes de aplicativos e locais <code>.webapp</code> que você deseja empacotar em um processo batch. O formato desse arquivo é:</p>

<pre>    myFirstApp,https://www.firstapp.com/manifest.webapp
    mySecondApp,https://www.secondapp.com/manifest.webapp
    etc.</pre>

<p>Você precisa salvar esse arquivo <code>list</code> no mesmo diretório do script <code>preload.py</code>, e então executar o seguinte comando:</p>

<pre>    $ python preload.py</pre>

<p>O script <code>preload.py</code> irá fazer um parse da lista e fazer a conversão para você.</p>

<h3 id="metadata.json_para_aplicativo_web_pré-empacotado">metadata.json para aplicativo web pré-empacotado</h3>

<p>Todo aplicativo web pré-empacotado deve ter um arquivo <code>metadata.json</code> no seu diretório raiz. O <a href="https://marketplace.firefox.com/">Firefox Marketplace</a> conta com esse arquivo <code>metadata.json</code> para a atualização automática. Esse arquivo é gerado automaticamente pelo script preload.py.<br>
 <br>
 Para um aplicativo hospedado, as propriedades do arquivo <code>metadata.json</code> são:</p>

<ul>
 <li><code>origin</code>: O nome do domínio da URL do aplicativo.</li>
 <li><code>manifestURL</code>: O local do manifesto para o aplicativo hospedado.</li>
 <li><code>installOrigin(hosted)</code>: O local do aplicativo instalado numa customização. Para customizações deve ser sempre <code>https://marketplace.firefox.com</code>.</li>
 <li><code>etag</code>: isso é usado para verificar atualizações. O valor do <code>etag</code> é recuperado pelo header <code>parse</code> <code>html</code> quando o arquivo <code>.webapp</code> é baixado do servidor.</li>
 <li><code>"removable": false</code>; Defina isso como <code>true</code> para fazer com que o aplicativo não possa ser removido da tela inicial.</li>
 <li><code>"type": "hosted"</code>; Defina o <code>type</code> como <code>hosted</code> para permissões padrão para seu aplicativo. Tipos <code>privileged</code> e <code>certified</code> não são permitidos para aplicativos hospedados.</li>
</ul>

<p>Para um aplicativo empacotado, as propriedades do arqvuivo <code>metadata.json</code> são:</p>

<ul>
 <li><code>origin</code>: A origem será <code>app://&lt;app name&gt;</code>, por exemplo: <code>app://poppit</code>.</li>
 <li><code>manifestURL</code>: Deve ser o local do mini-manifeseto. Para customizações, o  <code>manifestURL</code> sempre será um mini-manifesto do <code>marketplace.firefox.com</code>.</li>
 <li><code>installOrigin(hosted)</code>: O local do aplicativo instalado de uma customização, sempre deve ser <code>https://marketplace.firefox.com</code>.</li>
 <li><code>etag</code>: isso é usado para verificar atualizações. O valor do <code>etag</code> é recuperado pelo header <code>parse</code> <code>html</code> quando o arquivo <code>.webapp</code> é baixado do servidor.</li>
 <li><code>packageEtag</code>: Esse é o <code>etag </code>do aplicativo empacotado<code>,</code> recuperado pelo header <code>parse html</code> quando o pacote é baixado do servidor na primeira vez que uma atualização é detectada.</li>
 <li><code>"removable": false</code>; Defina isso como <code>true</code> para fazer com que o aplicativo não possa ser removido da tela inicial.</li>
 <li><code>"type": "privileged"</code>; Defina o <code>type</code> para <code>privileged</code> para conseguir premissões extras, defina <code>type</code> como <code>certified</code> para conseguir o maior nível de permissionamento para os recursos de sistema do Firefox OS.</li>
</ul>

<h3 id="Formato_do_arquivo_update.webapp">Formato do arquivo update.webapp</h3>

<p>Aplicativos empacotados têm um arquivo chamado <code>update.webapp</code>, que é utilizado para atualizações automáticas. O formato é similar ao do arquivo <code>manifest.webapp</code>, mas você deve incluir alguns atributos:</p>

<ul>
 <li><code>package_path</code> é o caminho para o arquivo compactado (zip).</li>
 <li><code>size</code> é o tamanho do pacote em bytes.</li>
</ul>

<pre class="brush: js">  {
    "name": "Game Pack",
    "icons": {"60": "/icon-60.png", "128": "/icon-128.png"},
    "version": "1.1.2",
    "package_path": "/application.zip",
    "developer": {"url": "http://abc.com", "name": "abc Inc."},
    "release_notes": "2nd release",
    "locales": {"es": {"launch_path": "/index-es.html", "description": "show me customization."}},
    "size": 5460141
  }</pre>

<h3 id="Formato_do_aplicativo_pré-empacotado">Formato do aplicativo pré-empacotado</h3>

<h3 id="AppCache.">AppCache.</h3>

<p>Se o arquivo <code>manifest.webapp</code> do seu aplicativo tem um <code>appcache_path</code> incluído nele, o script <code>preload.py</code> irá trazer o arquivo AppCache indicado e preparar a busca de todos os recursos descritos no arquivo AppCache. O aplicativo pré-empacotado AppCache é um pouco diferente já que o Gecko reconhece um formato diferente, mas é gerado automaticamente pelo script <code>preload.py</code>.</p>

<p>A estrutura do arquivo é:</p>

<pre>    &lt;app name&gt;
       ├── manifest.webapp
       └── cache
             ├── manifest.appcache
             └── &lt;resources&gt;
</pre>

<div class="note">
<p><strong>Nota</strong>: Se for indicado um nome diferente para o arquivo AppCache em <code>appcache_path</code>, deve ser renomeado em <code>manifest.appcache</code> e salvo no diretório <code>cache</code>.</p>
</div>

<h2 id="Perguntas_Frequentes">Perguntas Frequentes</h2>

<p>A seguir uma lista de perguntas comuns sobre customizações comerciais.</p>

<h3 id="O_que_pode_ser_customizado">O que pode ser customizado?</h3>

<ul>
 <li>Marca
  <ul>
   <li>Animações de inicialização e desligamento do dispositivo.</li>
   <li>Nome da rede na tela bloqueada e na bandeja de utilitários.</li>
   <li>Logos no procedimento de primeiro uso.</li>
  </ul>
 </li>
 <li>Localização
  <ul>
   <li>Localizações instaladas (shared/locales)</li>
   <li>Localização padrão (<code>GAIA_DEFAULT_LOCALE</code>)</li>
   <li>Layout padrão do teclado (Vários teclados podem ser habilitados, não vinculados ao local)</li>
  </ul>
 </li>
 <li>Aplicativos
  <ul>
   <li>Aplicativos de terceiros pré-instalados (Gerenciado por <code>customize.py</code>)</li>
   <li>Localização dos aplicativos na tela de início (Gerenciado por <code>customize.py</code>)</li>
   <li>Licença</li>
   <li>Configuração do provedor do processo de pagamento no aplicativo</li>
  </ul>
 </li>
 <li>Configurações
  <ul>
   <li>Brilho da tela padrão</li>
   <li>Informação do dispositivo — Modelo (nome ou código)</li>
   <li>Informação do dispositivo — Conteúdo ou link para informações legais</li>
   <li>Ajuda — Link para suporte online</li>
   <li>Ajuda — Número telefônico do suporte</li>
   <li>Ajuda — Link para guia do usuário</li>
   <li>APN</li>
   <li>Limitação do tamanho da mensagem MMS</li>
   <li>Modo de recuperação de mensagem MMS</li>
  </ul>
 </li>
 <li>Mídias pré-carregadas
  <ul>
   <li>Papeis de parede</li>
   <li>Música</li>
   <li>Vídeos</li>
   <li>Galeria</li>
  </ul>
 </li>
 <li>Sons
  <ul>
   <li>Início e desligamento do dispositivo</li>
   <li>Toques do celular</li>
   <li>Som das mensagens</li>
  </ul>
 </li>
 <li>Everything.me
  <ul>
   <li>Opção para habilitar ou desabilitar essa funcionalidade</li>
   <li>Conjutno de categorias padrão e aplicativos</li>
  </ul>
 </li>
 <li>Navegador
  <ul>
   <li>Favoritos padrão</li>
   <li>Motor de busca padrão</li>
  </ul>
 </li>
</ul>

<h3 id="Como_e_onde_definir_o_layout_customizado_do_grid_de_aplicativos">Como e onde definir o layout customizado do grid de aplicativos?</h3>

<p>Atualmente é definido em <code>gaia/apps/homescreen/js/init.json</code>. <code>customize.py.</code> Seja cuidadoso com o formato desse arquivo.</p>

<h3 id="É_possível_definir_se_um_aplicativo_é_removível_da_tela_de_início">É possível definir se um aplicativo é removível da tela de início?</h3>

<p>Não. Todos os aplicativos em <code>/system/b2g</code> são não removíveis, os que estão em <code>/data</code> são removíveis. Uma vez que todos os aplicativos pré-carregados vêm do diretório <code>/system</code>, nós precisamos movê-los para o diretório <code>/data</code> se quisermos que sejam removíveis.</p>

<h3 id="Como_adicionar_um_aplicativo_empacotado_ou_hospedado_na_imagem">Como adicionar um aplicativo empacotado ou hospedado na imagem?</h3>

<p>Ambos devem ser incluídos em <code>gaia/external-apps</code>. <code>customize.py</code> vai permitir a entrada do URL do manifesto de um aplicativo hospedado ou empacotado, baixá-lo no local correto e criar o arquivo<code> metadata.json</code>. Isso funcionará como a "etapa de compilação".</p>

<p>Nós temos metadados diferentes para aplicativos empacotados e hospedados para que seja possível distinguí-los.</p>

<p>Veja <a href="#Building_Prebundled_web_apps">compilando aplicativos pré-empacotados</a> para mais detalhes.</p>

<h3 id="Como_preparar_um_aplicativo_hospedado_pré-carregado_para_o_suporte_inicial_offline">Como preparar um aplicativo hospedado pré-carregado para o suporte inicial offline?</h3>

<p>Você precisa fornecer todos os arquivos para o cache no diretório <code>external-apps/MY_APP/cache</code>, juntamente com o manifesto AppCache.</p>

<p>Novamente, veja <a href="#Building_Prebundled_web_apps">compilando aplicativos pré-empacotados</a> para mais detalhes.</p>

<h3 id="Quais_customizações_do_Marketplace_são_possíveis">Quais customizações do Marketplace são possíveis?</h3>

<ul>
 <li>No dispositivo
  <ul>
   <li>A customização do dispositivo em relação a pagamentos se limita a preencher uma whitelist de provedores de pagamento. Há um conjunto de preferências para isso, documentados em <a href="https://wiki.mozilla.org/WebAPI/WebPayment#Testing">Pagamentos Web</a>.</li>
   <li>Por exemplo, os telefones Mozilla B2G são enviados com <a href="https://github.com/mozilla/webpay#readme">nossa implementação do provedor de pagamento</a> numa whitelist que é acessível ao Marketplace e aplicativos de terceiros para compras a partir do aplicativo via {{ domxref("navigator.mozPay") }}. Encontre mais informações sobre provedores de pagamento em <a href="https://wiki.mozilla.org/WebAPI/WebPaymentProvider">Provedores de pagamento via Web</a>.</li>
   <li>Se alguma empresa quiser implementar seu próprio processamento de pagamento e colocá-la na whitelist, está livre para isso. Porém, por enquanto, o <a href="https://marketplace.firefox.com/">Firefox Marketplace</a> está configurado somente para habilitar compras através dos provedores de pagamento da Mozilla.</li>
  </ul>
 </li>
 <li>No servidor
  <ul>
   <li>O aplicativo que comercializa produtos/serviços define o preço para o produto e o processador de pagamentos da Mozilla seleciona a moeda baseado na rede do usuário. Nada, como moeda, taxas ou impostos regionais ou L10N são controlados por configurações no dispositivo (ainda).</li>
   <li>Categorias específicas no Firefox Marketplace para a empresa com o logo/nome da operadora na região.</li>
   <li>Aplicativos em destaque / promoções no Firefox Market Place, especificados pela operadora.</li>
  </ul>
 </li>
</ul>

<p>Existem muitas outras considerações quando incluir uma região ou operadora. Veja <a href="https://wiki.mozilla.org/Marketplace/AddingRegionsAndCarriers">Incluindo Regiões e Operadoras</a> para mais detalhes.</p>

<h3 id="Como_fazer_para_empacotar_e_armazenar_alterações_nas_customizações_comerciais">Como fazer para empacotar e armazenar alterações nas customizações comerciais?</h3>

<p>Armazene somente os arquivos alterados, atualmente estão em vários locais no sistema de arquivos. No B2G v2, estamos considerando isso num único local, similar aos diretórios de marcas que temos hoje no Gecko.</p>

<h3 id="Como_compilar_o_produto_com_uma_configuração_comercial_específica">Como compilar o produto com uma configuração comercial específica?</h3>

<p>Copie seus arquivos alterados em um <em>checkout</em> do Gaia. <code>customize.py</code> fornecerá uma interface para definir o que for relevante, criar arquivos apropriados em locais apropriados no <em>checkout</em> do Gaia, então compile o perfil desse Gaia.</p>

<h3 id="Como_customizar_a_animação_da_inicialização_desligamento">Como customizar a animação da inicialização / desligamento?</h3>

<ul>
 <li>Essa animação usa <a href="http://www.droidforums.net/forum/droid-hacks/33932-bootanimation-zip-file-explained.html">o formato do Android <code>bootanimation.zip</code>/<code>desc.txt</code></a>.</li>
 <li>Isso nos faz criar uma sequência de animação <em>multi-part</em> na qual nós podemos especificar coisas como tamanho, framerate e número de vezes que cada parte da animação se repete.</li>
 <li>Existe também transições animada de arquivos PNG que preenche o espaço entre a sequência <code>bootanimation.zip</code> e a transição para a tela de bloqueio, que é executada pelo Gaia.</li>
 <li>O tamanho no disco da animação padrão é de 8.2MB (looping) + 3.6MB (transição do frame 18) = Total de 11.8MB.</li>
 <li>Atualmente, a animação de desligamento é uma animação customizada de css baseado num design específico em {{ Bug("809342") }}.</li>
</ul>
