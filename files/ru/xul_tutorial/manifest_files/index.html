---
title: Файлы манифеста (Manifest)
slug: XUL_Tutorial/Manifest_Files
translation_of: Archive/Mozilla/XUL/Tutorial/Manifest_Files
---
<p>{{PreviousNext("XUL/Tutorial/The_Chrome_URL", "XUL/Tutorial/Creating_a_Window")}}</p>
<p>В этой главе мы опишем, как собирать chrome и XUL файлы в пакеты и как создавать для этих пакетов файлы манифестов.</p>
<div id="section_1">
 <h2 id="Пакеты">Пакеты</h2>
 <div class="editIcon">
  Пакет - это набор XUL файлов и сценариев, определяющих функциональность пользовательского интерфейса. Пакеты могут быть инсталлированы в Mozilla и на них можно ссылаться с помощью chrome URL-ов. Пакет может содержать любые типы файлов и может быть распределен по поддиректориям для разных частей пакета. На диске пакет может храниться либо в распакованном виде с своей папке, либо в виде JAR архива.</div>
 <div class="editIcon">
   </div>
 <h2 id="Manifest_Files" name="Manifest_Files">Файлы Манифеста</h2>
</div>
<div id="section_2">
 <p>Файлы манифеста описывают пакет и отображают его расположение на диске на chrome URL. Файлы манифеста расположенные в папке chrome (<a href="../../../../en/Runtime_Directories#Firefox" rel="internal" style="text-decoration: none; color: rgb(51, 102, 153) !important; cursor: default; background-clip: initial; background-color: initial; padding-right: 0px;">&lt;ApplicationDirectory&gt;</a>/chrome) считываются при запуске приложения Mozilla для того, чтобы определить, какие пакеты установлены. Это означает, что все, что вам необходимо сделать для того, чтобы установить новый пакет, это добавить новый файл манифеста либо в папку chrome приложения или в папку chrome определенного пользователя. Второй из вышеперечисленных вариантов можно использовать, если у вас нет достаточных прав на запись в папку самого приложения.</p>
 <p>Если вы хотите только попробовать тестирование привилегированного XUL кода в браузере Firefox, вы можете легко сделать это использовав манифест, состоящий всего лишь из одной строки:</p>
 <ol>
  <li>Создайте новую папку где-нибудь на диске. Например на компьютере под управлением Windows вы можете создать папку "C:\testfiles".</li>
  <li>Создайте новый <strong>ASCII</strong><sup>1</sup> файл с именем test.manifest в папке chrome. Имя файла не имеет особого значения, главное, чтобы его расширение было .manifest. <sub>( 1. не работает с UTF-8 с BOM.) </sub></li>
  <li>Напишите в созданном файле строку:</li>
 </ol>
 <pre class="eval"> content tests <a class="external" rel="freelink">file:///C:/testfiles/</a>
</pre>
 <p>Путь к файлам должен указывать на папку, которую вы создали на первом шаге. Если вы не уверены, каков путь к этой папке, откройте папку в браузере и скопируйте адрес из адресной строки.</p>
 <p>Это все! Теперь все, что вам нужно сделать, это добавить несколько XUL файлов в эту новую папку, и вы сможете загружать их набирая chrome URL следующего вида "<a class="external" rel="freelink">chrome://tests/content/tests.xul</a>&lt;filename&gt;". Конечно же вам необходимо перезапустить браузер, чтобы внесенные изменения вступили в силу. Если же файл не загружается, проверьте, правильно ли вы указали путь к папке.</p>
 <p>Базовый синтаксис строк файла манифеста для пакетов контента следующий:</p>
 <p>'content &lt;packagename&gt; &lt;filepath&gt;'</p>
 <p>Первое поле 'content' обозначает пакет контента. Для тем это будет 'skin', а 'locale' - соответственно для локалей. Название пакета в вышеприведенном примере - 'tests', что означает, что первое поле в chrome URL - это 'tests', как например <a class="external" rel="freelink">chrome://tests/content/sample.xul</a>. Если бы название пакета было 'browser', chrome URL выглядел бы так <a class="external" rel="freelink">chrome://browser/content/browser.xul</a>. Последнее поле - это путь к папке, в которой находятся файлы. Это может быть как путь к папке на локальном диске указанный как URL файла, так и к JAR архиву, указанному с помощью jar URL, который мы опишем ниже. Вы можете описать несколько пакетов включив еще строки в файл манифеста.</p>
 <p>Файл browser.manifest, который используется в Firefox, выглядит примерно так:</p>
 <pre>content branding jar:browser.jar!/content/branding/ xpcnativewrappers=yes
content browser jar:browser.jar!/content/browser/ xpcnativewrappers=yes
overlay chrome://global/content/viewSource.xul chrome://browser/content/viewSourceOverlay.xul
overlay chrome://global/content/viewPartialSource.xul chrome://browser/content/viewSourceOverlay.xul
overlay chrome://browser/content/pageInfo.xul chrome://pippki/content/PageInfoOverlay.xul
</pre>
 <p>Здесь перечислены два пакета, 'branding' и 'browser'. Также указаны три оверлея, что дает возможность объединять вместе контент из разных пакетов. В расширениях оверлеи используются максимально часто, так как расширения интегрируют свой интерфейс в интерфейс браузера.</p>
 <p>Пути к файлам пакетов  'branding' и 'browser' используют JAR URL, поскольку контент упаковывается в архив. Архив JAR может быть создан с помощью утилиты ZIP. Для файла JAR, расположенного в каталоге chrome, синтаксис довольно прост:</p>
 <p>jar:&lt;filename.jar&gt;!/&lt;path_in_archive&gt;</p>
 <p>Для пакета 'browser' архив - browser.jar, располагается рядом с файлом манифеста в каталоге chrome. Путь 'content/browser' указывает путь внутри архива, в котором располагаются файлы XUL. Вам не требуется указывать путь, если у вас нет никаких каталогов в архиве. В этом случае файлы пакета 'branding' хранятся по другому пути в том же самом архиве.</p>
 <p>Для пакета 'tests', созданного выше, файлы не упаковываются в архив, вместо этого используется прямой путь доступа к файлам. Это хорошо для разработки, так как вы не должны упаковывать все файлы каждый раз, когда вы изменяете их. Однако, при распространении приложения или расширения, вы скорее всего захотите упаковать их в архив, чтобы избежать необходимости устанавливать множество отдельных мелких файлов.</p>
 <p>Часть xpcnativewrappers=yes в конце строки декларации - флаг, который может использоваться опционально. В JavaScript для веб-страницы возможно переопределить встроенные функции с их собственным кодом. Если используется флаг xpcnativewrappers, это указывает, что сценарии, выполняющиеся в привилегированном окружении, не вызывают эти переопределенные версии, а используют вместо этого исходные встроенные версии. Иначе, если бы расширение попыталось вызвать модифицированные версии, то оно, вероятно, не работало бы должным образом, или хуже, создало бы дыру в системе безопасности. Этот флаг был добавлен, чтобы предотвратить эту проблему и должен всегда использоваться для более новых расширений, но не учитывается для более старых расширений, которые могут быть несовместимыми с изменением. Для получения дополнительной информации об этой функции, см. <a href="../../../../en/XPCNativeWrapper" rel="internal">XPCNativeWrapper</a>.</p>
</div>
<h2 class="editable" id="Темы_и_локали"><span>Темы и локали</span></h2>
<div class="editIcon">
 Для тем и локалей синтаксис сходен с используемым для пакетов контента, но вы всегда должны указывать пакет контента, для которого вы предоставляете тему или локаль. Например:</div>
<pre>skin browser classic/1.0 jar:classic.jar!/skin/classic/browser/
locale browser en-US jar:en-US.jar!/locale/browser/
</pre>
<p>Для этого было добавлено новое поле, указывающее, что эти тема и локаль используются для браузера. Имя скина - 'classic/1.0'. В данном случае номер версии является частью названия темы, но это необязательно, если вы создаете свою собственную тему. Mozilla не обрабатывает номер версии каким-либо особенным образом; номер версии - это просто часть названия темы. Локаль - 'en-US'. Chrome URL-ы на которые отображаются эти элементы будут выглядеть так: <a class="external" rel="freelink">chrome://browser/skin/browser.css</a> и <a class="external" rel="freelink">chrome://browser/locale/browser.dtd</a>. Если вы создаете свою собственную тему или локаль для браузера, все, что вам необходимо - создать файл манифеста с одной из двух этих строк внутри него, измененной так, чтобы подходить к вашей теме или локали.</p>
<p>Более подробную информацию о темах см. здесь <a href="../../../../en/Themes" rel="internal">Темы</a>. Более подробно о локалях см. здесь <a href="../../../../en/Localization" rel="internal">Локализация</a>.</p>
<div class="highlight">
 <div id="section_4">
  <h2 id="Наш_пример_диалога_поиска_файлов">Наш пример диалога поиска файлов</h2>
  <p>Давайте создадим файл манифеста для диалога поиска файлов, который мы будем разбирать в качестве примера в этом руководстве. Вы можете комбинировать все три типа в одном файле, если хотите. Это можно сделать создав расширение таким образом, что все части будут в одном файле. Мы проделаем это для диалога поиска файлов. Создайте файл findfile.manifest в папке chrome. Впишите в него следующие строки:</p>
  <div>
    </div>
  <pre>content findfile file:///findfile/content/
skin findfile classic/1.0 file:///findfile/skin/
locale findfile en-US file:///findfile/locale/
</pre>
  <p>Создайте новые папки, перечисленные выше. Не имеет значения, где именно будут созданы эти папки, но файловые пути в манифесте должны указывать на эти папки. Скорее всего вы будете использовать такие пути к папкам, которые удобно использовать в вашей операционной системе. Если бы мы распространяли пакет, мы бы упаковали все файлы в JAR файл, и модифицировали бы пути. В данном же случае мы пока что только демонстрируем файлы манифестов и готовим папки для примеров, которые будут описаны в нижеследующих главах.</p>
  <p>Заметьте, как второе поле строк для скина и локали указывает 'findfile'. Это означает, что скин и локаль изменили пакет findfile, который был указан в первой строке. Три пути выше указывают подкаталоги для каждой части. Возможно вы захотите создать эти подкаталоги, чтобы держать все файлы по отдельности.</p>
  <p> </p>
 </div>
</div>
<div id="section_5">
 <h2 id="Установка_пакета">Установка пакета</h2>
 <p class="editIcon">Для того, чтобы установить приложение, вы должны сделать для него инсталлятор или включить его в инсталлятор другого приложения. Используемый метод зависит от того, какого рода приложение вы создаете. Для расширений вам необходимо будет создать файл <a href="../../../../en/Install_Manifests" rel="internal">install.rdf</a>, который описывает, что именно будет установлено, кто является автором расширения и какая версия браузера или другого приложения совместима с вашим расширением. Необходима <a href="../../../../en/Bundles" rel="internal">Особая структура папок</a>, так как для расширений действуют ограничения на месторасположение, в которое они могут устанавливать свои файлы. Расширение упаковывается в <a href="../../../../en/XPI" rel="internal">XPI</a> файл. XPI это сокращение от <a href="../../../../en/XPInstall" rel="internal">XPInstall</a> и используется для установки компонентов Mozilla-ой. Подобно JAR файлу XPI это всего лишь ZIP архив, но с другим расширением, поэтому вы можете создавать XPI файлы с помощью ZIP архиватора.</p>
 <p>Менеджер расширений Firefox выполняет установку расширений, упакованных в XPI файлы, автоматически. Рекомендуется выкладывать все расширения на <a class="link-https" href="https://addons.mozilla.org/" rel="external nofollow" title="https://addons.mozilla.org/">Сайт дополнений Mozilla</a>, на котором пользователи могут найти, чтобы установить. Конечно расширения можно устанавливать с любых сайтов, но другие сайты не сконфигурированы так, чтобы позволять установку по умолчанию.</p>
 <p>Также для установки файлов можно использовать сценарий на языке JavaScript. Это позволяет вам копировать файлы в любое месторасположение на диске и выполнять другие задания управления файлами. Однако приложения, установленные с помощью сценария не будут отображаться в менеджере расширений, к тому же не будет возможности их автоматизированной деинсталляции. Из-за этих причин сценарии установки используются не часто.</p>
 <p>Что касается самостоятельных приложений, то их можно упаковать с помощью программы XULRunner. При этом будет создан отдельный исполняемый файл, и приложение может быть установлено независимо от браузера.</p>
 <p>Более подробно о создании расширений см. <a href="../../../../en/Extensions" rel="internal">Расширения</a>. Дополнительная информация о XULRunner, в главе <a href="../../../../en/XULRunner" rel="internal">XULRunner</a>.</p>
</div>
<div id="section_6">
 Устаревшие приложения<br>
 <p>Если вы создаете приложения для устаревших версий программ Mozilla, т.е., до Firefox 1.5 или Mozilla 1.8, процесс немного усложняется. Ниже описано, как создать пакет для старых версий. Этот раздел можно пропустить, если вы создаете только новые расширения или XUL приложения.</p>
 <div class="note">
  <strong>Примечание</strong>: Этот устаревший процесс, но он тем не менее также используется и для нового продукта SeaMonkey 1.0. Ядро кода этого проекта еще не работает с новым форматом <em>"Manifest"</em>.</div>
 <pre class="eval">&lt;?xml version="1.0"?&gt;

&lt;RDF:RDF xmlns:RDF="<a class="external" href="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rel="freelink">http://www.w3.org/1999/02/22-rdf-syntax-ns#</a>"
         xmlns:chrome="<a class="external" href="http://www.mozilla.org/rdf/chrome#" rel="freelink">http://www.mozilla.org/rdf/chrome#</a>"&gt;

  &lt;RDF:Seq about="urn:mozilla:package:root"&gt;
    &lt;RDF:li resource="urn:mozilla:package:<span style="color: rgb(255, 0, 0);"><span class="highlightred">myapplication</span></span>"/&gt;
  &lt;/RDF:Seq&gt;

  &lt;RDF:Description about="urn:mozilla:package:<span style="color: rgb(255, 0, 0);"><span class="highlightred">myapplication</span></span>"
          chrome:displayName="<span style="color: rgb(0, 0, 255);"><span class="highlightblue">Application Title</span></span>"
          chrome:author="<span style="color: rgb(0, 0, 255);"><span class="highlightblue">Author Name</span></span>"
          chrome:name="<span style="color: rgb(255, 0, 0);"><span class="highlightred">myapplication</span></span>"
          chrome:extension="true"/&gt;

&lt;/RDF:RDF&gt;
</pre>
 <pre class="eval">content,install,url,<span class="highlightred"><a class="external" rel="freelink">file:///main/app/</a></span>
</pre>
 <ol>
  <li>Создайте папку где-либо на вашем жестком диске. Многие создают подкаталог в папке chrome Mozilla, но это вовсе не обязательно. Папка может располагаться в любом месте на любом диске. Поместите ваши XUL файлы в эту папку.</li>
  <li>Создайте файл с именем "contents.rdf" и поместите его также в эту папку. Скопируйте текст из рамки ниже в ваш файл "contents.rdf". Этот файл используется для определения идентификатора приложения, его названия, автора, версии и т.п. данных.</li>
  <li>Измените выделенные части файлы выше на вашу собственную информацию. Текст 'myapplication' выделенный красным замените на ID вашего приложения. Вы можете выбрать любое название, но, как правило, ID делают совпадающим с названием всего приложения в целом. Замените выделенный синим цветом текст на название вашего приложения и имя его автора.</li>
  <li>Если поле 'chrome:extension' равно истине, приложение является расширение для Mozilla Firefox и будет отображаться в окне Расширений в настройках браузера. Если же вы установите значение "false", в окне расширений его видно не будет.</li>
  <li>Запишите "contents.rdf" и убедитесь, что он находится в папке, которую вы создали на шаге №1.</li>
  <li>Откройте &lt;mozilla-directory&gt;/chrome/installed-chrome.txt, где &lt;mozilla-directory&gt; - это папка, в которую установлена ваша Mozilla. Выйдите из Mozilla прежде чем выполнить данный шаг.</li>
  <li>Далее, вы должны зарегистрировать новое приложение в Mozilla, чтобы она знала, где его искать. Добавьте строку в конец файла "installed-chrome.txt", указывающую на новую, созданную вами на Шаге №1, папку. Измените выделенный текст на адрес папки в формате URL. Убедитесь в том, что в этой ссылке в конце строки стоит косая черта и что вы нажали Enter в конце строки, т.е. создали пустую строку. Если вы не уверены, каким должен быть URL, откройте папку, созданную на Шаге №1 в браузере Mozilla и скоируйте URL из поля адреса. Помните, что ссылка эта должна быть адресом папки, но не файла.</li>
  <li>Удалите файл &lt;mozilla-directory&gt;/chrome/chrome.rdf.</li>
  <li>Запустите Mozilla. Вам должны быть доступны любые XUL файлы, которые вы поместили в папку, с помощью URL вида: <strong>chrome://<span class="highlightred">applicationid</span>/content/file.xul</strong> где "file.xul" - это имя файла. Главный XUL файл, который вы можете загрузить с помощью URL ярлыка <strong>chrome://<span class="highlightred">applicationid</span>/content/</strong>, будет иметь вид "applicationid.xul".</li>
 </ol>
 <p>Если вы создаете части скина и/или локали, повторите вышеприведенные шаги, с отличием в том, что формат файла "contents.rdf" будет несколько иным. Вы можете посмотреть на файлы "contents.rdf" других приложений, чтобы узнать подробности.</p>
</div>
<h2 class="editable" id="Выявление_неисправностей"><span>Выявление неисправностей </span></h2>
<p>Создание chrome пакетов часто может быть довольно сложным и выявить возникающие проблемы непросто. Ниже приводится несколько советов на тот случай, если у вас что-то застопорилось.</p>
<ul>
 <li>Откройте файл &lt;mozilla-directory&gt;/chrome/chrome.rdf. Вы найдете там ссылки на ваш ID приложения. Если его там нет, что-то неверно с регистрацией. Если он там есть, возможно вы используете неверный chrome URL при загрузке файла.</li>
 <li>Попробуйте удалить файл &lt;mozilla-directory&gt;/chrome/chrome.rdf. Он будет создан заново. Также удалите полностью папку &lt;mozilla-directory&gt;/chrome/overlayinfo/, если вы используете оверлеи.</li>
 <li>Убедитесь, что URL в строке, которую вы добавили в installed-chrome.txt, заканчивается косой чертой, а сам файл завершается пустой строкой.</li>
 <li>В ОС Windows, URL файлов выглядят так "<a class="external" rel="freelink">file:///C</a>|/files/app/", где "C" - буква диска.</li>
 <li>Убедитесь, что файл "contents.rdf" находится в правильной папке и составлен правильно. Откройте файл "contents.rdf" в Mozilla, чтобы проверить, что он парсится, как валидный XML. Если это не так, вы увидите сообщение об ошибке на желтом фоне.</li>
 <li>Если вы используете отладочную сборку (build) Mozilla, при запуске на терминал будет выведена некоторая информация, сообщающая, какие chrome приложения проверяются. Посмотрите, есть ли ваше приложение в этом списке.</li>
 <li>Сообщение об ошибке "XML Parsing Error: undefined entity" в вашем XUL файле может быть вызвано ошибкой в манифесте или в jar файле, на который есть ссылка в манифесте. Например, в &lt;!DOCTYPE window SYSTEM "<a class="external" rel="freelink">chrome://fireclipse/locale/fireclipse.dtd</a>"&gt; файл dtd должен существовать и его папка должна быть правильно адресована в манифесте "locale", в противном случае при парсинге XML произойдет ошибка.</li>
</ul>
<p>Более подробную информацию о файлах манифеста см. <a href="../../../../en/Chrome_Registration" rel="internal">Регистрация Chrome</a>.</p>
<p>В следующей главе мы приступаем к более подробному описанию языка XUL.</p>
<p>{{PreviousNext("XUL/Tutorial/The Chrome URL", "XUL/Tutorial/Creating a Window")}}</p>
